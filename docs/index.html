<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pun Suparattanapinan">

<title>Macroeconometrics Research Report - The Impact of Monetary Policy on the Real Economy and the Stock Market: The Case of Australia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Macroeconometrics Research Report</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#preliminary-results" id="toc-preliminary-results" class="nav-link" data-scroll-target="#preliminary-results">Preliminary Results</a>
  <ul class="collapse">
  <li><a href="#the-autocorrelation-and-partial-autocorrelation" id="toc-the-autocorrelation-and-partial-autocorrelation" class="nav-link" data-scroll-target="#the-autocorrelation-and-partial-autocorrelation">The autocorrelation and partial autocorrelation</a></li>
  <li><a href="#the-unit-root-test" id="toc-the-unit-root-test" class="nav-link" data-scroll-target="#the-unit-root-test">The unit root test</a></li>
  </ul></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">Methodology</a></li>
  <li><a href="#estimation-algorithm-with-simulated-data" id="toc-estimation-algorithm-with-simulated-data" class="nav-link" data-scroll-target="#estimation-algorithm-with-simulated-data">Estimation algorithm with simulated data</a>
  <ul class="collapse">
  <li><a href="#the-baseline-model" id="toc-the-baseline-model" class="nav-link" data-scroll-target="#the-baseline-model">The baseline model</a>
  <ul class="collapse">
  <li><a href="#estimation-algorithm" id="toc-estimation-algorithm" class="nav-link" data-scroll-target="#estimation-algorithm">Estimation algorithm</a></li>
  <li><a href="#data-simulation" id="toc-data-simulation" class="nav-link" data-scroll-target="#data-simulation">Data simulation</a></li>
  </ul></li>
  <li><a href="#the-extension-model" id="toc-the-extension-model" class="nav-link" data-scroll-target="#the-extension-model">The extension model</a>
  <ul class="collapse">
  <li><a href="#estimation-algorithm-1" id="toc-estimation-algorithm-1" class="nav-link" data-scroll-target="#estimation-algorithm-1">Estimation algorithm</a></li>
  <li><a href="#data-simulation-1" id="toc-data-simulation-1" class="nav-link" data-scroll-target="#data-simulation-1">Data simulation</a></li>
  </ul></li>
  <li><a href="#stochastic-volatility-heteroskedasticity" id="toc-stochastic-volatility-heteroskedasticity" class="nav-link" data-scroll-target="#stochastic-volatility-heteroskedasticity">Stochastic Volatility Heteroskedasticity</a>
  <ul class="collapse">
  <li><a href="#estimation-algorithm-2" id="toc-estimation-algorithm-2" class="nav-link" data-scroll-target="#estimation-algorithm-2">Estimation algorithm</a></li>
  <li><a href="#data-simulation-2" id="toc-data-simulation-2" class="nav-link" data-scroll-target="#data-simulation-2">Data simulation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#empirical-estimation" id="toc-empirical-estimation" class="nav-link" data-scroll-target="#empirical-estimation">Empirical estimation</a>
  <ul class="collapse">
  <li><a href="#the-baseline-model-3" id="toc-the-baseline-model-3" class="nav-link" data-scroll-target="#the-baseline-model-3">The baseline model</a>
  <ul class="collapse">
  <li><a href="#impulse-response-function" id="toc-impulse-response-function" class="nav-link" data-scroll-target="#impulse-response-function">Impulse response function</a></li>
  </ul></li>
  <li><a href="#the-extension-model-3" id="toc-the-extension-model-3" class="nav-link" data-scroll-target="#the-extension-model-3">The extension model</a>
  <ul class="collapse">
  <li><a href="#impulse-response-function-1" id="toc-impulse-response-function-1" class="nav-link" data-scroll-target="#impulse-response-function-1">Impulse response function</a></li>
  </ul></li>
  <li><a href="#the-baseline-with-stochastic-volatillity-model" id="toc-the-baseline-with-stochastic-volatillity-model" class="nav-link" data-scroll-target="#the-baseline-with-stochastic-volatillity-model">The baseline with Stochastic volatillity model</a>
  <ul class="collapse">
  <li><a href="#impulse-response-function-2" id="toc-impulse-response-function-2" class="nav-link" data-scroll-target="#impulse-response-function-2">Impulse response function</a></li>
  </ul></li>
  <li><a href="#the-extension-with-stochastic-volatillity-model" id="toc-the-extension-with-stochastic-volatillity-model" class="nav-link" data-scroll-target="#the-extension-with-stochastic-volatillity-model">The extension with Stochastic volatillity model</a>
  <ul class="collapse">
  <li><a href="#impulse-response-function-3" id="toc-impulse-response-function-3" class="nav-link" data-scroll-target="#impulse-response-function-3">Impulse response function</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">The Impact of Monetary Policy on the Real Economy and the Stock Market: The Case of Australia</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pun Suparattanapinan </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p><strong>Abstract.</strong> The purpose of this study is to investigate the relationship and impact of monetary policy on the real economy in Australia. The author uses quarterly data spanning from 1990 Q1 to 2023 Q4. The Structural Vector Autoregression (SVAR) model is used to capture the structural relationship, including analyzing the impulse responses of the variable of interest to structural shock.</p>
<p><strong>Keywords.</strong> Structural VAR, SVAR, monetary policy, stock market, economic impact, impulse response function, Bayesian, cash rate</p>
</blockquote>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This study aims to explore the dynamic impact of monetary policy on the real economy in Australia, specifically focusing on economic growth, prices, and employment. How does the real economy respond? What is the magnitude and the duration of change? The stock market price is included and can be considered a leading indicator of the real economy.</p>
<p>According to Economic theory, the transmission mechanism of monetary policy to the real economy takes time, as it does not have a fully immediate effect, but it involves some delays. <span class="citation" data-cites="BrischettoVoss1999">Brischetto and Voss (<a href="#ref-BrischettoVoss1999" role="doc-biblioref">1999</a>)</span> find that the contractionary of monetary policy in Australia leads to a decrease in output level between 5 and 15 quarters after the contraction. The price level also gradually falls with some delay with maximum effect, and there is an indication that the effect tends to be permanent. <span class="citation" data-cites="Mojon2001">Mojon and Peersman (<a href="#ref-Mojon2001" role="doc-biblioref">2001</a>)</span> also investigate the effect of monetary policy across 10 euro area countries and find that a contractionary monetary policy shock leads to a temporary fall in GDP that peaks typically around four quarters after the shock and a gradual decrease in the price level.</p>
<p>On the other hand, <span class="citation" data-cites="Bjornland2009">Bjørnland and Leitemo (<a href="#ref-Bjornland2009" role="doc-biblioref">2009</a>)</span> suggest that, due to the availability of information in financial market, the monetary policy and stock market have simultaneous effects. They also find that real stock prices immediately fall by seven to nine percent due to a monetary policy shock that raises the federal funds rate by 100 basis points. Similarly, <span class="citation" data-cites="Ioannidis2008">Ioannidis and Kontonikas (<a href="#ref-Ioannidis2008" role="doc-biblioref">2008</a>)</span> find that the majority of OECD countries under study, periods of tight money are associated with contemporaneous declines in stock market value and also decreases expected stock returns. Additionally, according to <span class="citation" data-cites="Bjornland2009">Bjørnland and Leitemo (<a href="#ref-Bjornland2009" role="doc-biblioref">2009</a>)</span>, the changes in asset price, particularly stock price, ultimately impact the economic growth by increasing household spending based on their wealth and encouraging investment through the Tobin Q effect. The asset prices also play a role in firm’s ability to fund operations through credit channel. Hence, policymakers are motivated to track the asset price as short-run indicators.</p>
<p>Understanding insights of these dynamic impacts within the macroeconomy, including the magnitude and duration of impacts, enables the policymakers to precisely predict the outcomes on real economy that might occur after changing the new cash target rate.</p>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<p>The variables in this study include the cash rate target <strong><em>(cashrate)</em></strong>, which indicates the monetary policy. GDP (in real terms), CPI, and the unemployment rate <strong><em>(unemprate)</em></strong> are included to measure the real economy. For the stock market, the author uses the All Ordinaries index (AORD) as a representative. The AORD is the market-weighted index and includes about 500 companies from the Australian Stock Exchange. Finally, total government expenditure is included to control for fiscal policy, which might also affect the economy besides monetary policy. The data is collected from the Reserve Bank of Australia (RBA), Australian Bureau of Statistics (ABS), and Yahoo Finance. The dataset spans from 1990 Q1 to 2023 Q4, comprising 136 observations. <a href="#figure-1-time-series-plots-raw-data">Figure 1: time series plots (raw data)</a> represents the raw data time series of these 6 variables.</p>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/plotting the raw data-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-1-time-series-plots-raw-data" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-1-time-series-plots-raw-data">Figure 1: time series plots (raw data)</h5>
</section>
<p><br></p>
<p>The author transforms the data in manner that aligns with the purpose of study. The total government expenditure are adjusted to real terms using the GDP deflator. After that, the author transforms 4 variables which are real GDP, AORD, CPI, and real government expenditure in logarithms term, denoted by <strong><em>realgdp</em></strong>, <strong><em>stockprice</em></strong>, <strong><em>CPI</em></strong>, and <strong><em>govexp</em></strong> respectively. <a href="#figure-2-time-series-plots-transformed-data">Figure 2: time series plots (transformed data)</a> represents the transformed data, which will be analyzed further.</p>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/Plotting the transformed data-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-2-time-series-plots-transformed-data" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-2-time-series-plots-transformed-data">Figure 2: time series plots (transformed data)</h5>
</section>
<p><br></p>
<p>The statistics summary of variables from 1990 Q1 to 2023 Q4 is shown in Table 1.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 1: Summary statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">N</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">St.Dev.</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cashrate</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">4.589</td>
<td style="text-align: right;">2.864</td>
<td style="text-align: right;">0.100</td>
<td style="text-align: right;">16.750</td>
</tr>
<tr class="even">
<td style="text-align: left;">realgdp</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">5.957</td>
<td style="text-align: right;">0.300</td>
<td style="text-align: right;">5.434</td>
<td style="text-align: right;">6.413</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPI</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">4.456</td>
<td style="text-align: right;">0.249</td>
<td style="text-align: right;">4.029</td>
<td style="text-align: right;">4.913</td>
</tr>
<tr class="even">
<td style="text-align: left;">unemprate</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">6.355</td>
<td style="text-align: right;">1.880</td>
<td style="text-align: right;">3.497</td>
<td style="text-align: right;">11.216</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stockprice</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">8.244</td>
<td style="text-align: right;">0.484</td>
<td style="text-align: right;">7.154</td>
<td style="text-align: right;">8.966</td>
</tr>
<tr class="even">
<td style="text-align: left;">govexp</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">10.800</td>
<td style="text-align: right;">0.609</td>
<td style="text-align: right;">9.811</td>
<td style="text-align: right;">11.898</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="preliminary-results" class="level1">
<h1>Preliminary Results</h1>
<section id="the-autocorrelation-and-partial-autocorrelation" class="level3">
<h3 class="anchored" data-anchor-id="the-autocorrelation-and-partial-autocorrelation">The autocorrelation and partial autocorrelation</h3>
<p>In this section, the autocorrelation and partial autocorrelation analyses are used to detect patterns and check the randomness of time series. <a href="#figure-3-acf-plots">Figure 3: ACF plots</a> show the autocorrelation remains in all variables, even after 5 years. This indicate the strong correlation between a time series and its lagged values.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/ACF plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-3-acf-plots" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-3-acf-plots">Figure 3: ACF plots</h5>
</section>
<p><br></p>
<p>For the PACF in <a href="#figure-4-pacf-plots">Figure 4: PACF plots</a>, it is observed that there have not been any significant spikes for all variables, except for <em>unemprate</em>. The PACF of <em>unemprate</em> indicates significance in partial autocorrelation at first and sixteenth quarter lags; however, this might occur due to a type I error.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/PACF plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-4-pacf-plots" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-4-pacf-plots">Figure 4: PACF plots</h5>
</section>
<p><br></p>
</section>
<section id="the-unit-root-test" class="level3">
<h3 class="anchored" data-anchor-id="the-unit-root-test">The unit root test</h3>
<p>In this section, the Augmented Dickey-Fuller Test (ADF Test) is used to test for the stationarity assumption. The null hypothesis is that the time series data has a unit root (non-stationary). The results are shown in Table 2. At the 1% significance level, the null hypothesis cannot be rejected for all variables, indicating that these variables are unit root non-stationary.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 2: ADF test</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Dickey-Fuller</th>
<th style="text-align: right;">Lag order</th>
<th style="text-align: right;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cashrate</td>
<td style="text-align: right;">-3.77</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">realgdp</td>
<td style="text-align: right;">-1.28</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.87</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPI</td>
<td style="text-align: right;">-3.11</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">unemprate</td>
<td style="text-align: right;">-2.61</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stockprice</td>
<td style="text-align: right;">-2.57</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.34</td>
</tr>
<tr class="even">
<td style="text-align: left;">govexp</td>
<td style="text-align: right;">-1.82</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.65</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Then, take the first difference and the second difference of all variables and rerun the ADF test. The results are shown in Table 3 and Table 4. For the first difference in Table 3, at the 1% significance level, the null hypothesis can be rejected for all variables, except <em>CPI</em> and <em>dgovexp</em>. It is reasonable to conclude that <em>cashrate</em>, <em>realgdp</em>, <em>unemprate</em>, <em>stockprice</em> are integrated of order 1. And <em>CPI</em> and <em>govexp</em> are integrated of order 2, as shown in the result in Table 4.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 3: ADF test on the first difference</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Dickey-Fuller</th>
<th style="text-align: right;">Lag order</th>
<th style="text-align: right;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dcashrate</td>
<td style="text-align: right;">-4.26</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">drealgdp</td>
<td style="text-align: right;">-5.73</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dCPI</td>
<td style="text-align: right;">-3.87</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">dunemprate</td>
<td style="text-align: right;">-4.94</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dstockprice</td>
<td style="text-align: right;">-5.47</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">dgovexp</td>
<td style="text-align: right;">-3.76</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.02</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 4: ADF test on the second difference</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Dickey-Fuller</th>
<th style="text-align: right;">Lag order</th>
<th style="text-align: right;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ddcashrate</td>
<td style="text-align: right;">-7.20</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">ddrealgdp</td>
<td style="text-align: right;">-8.20</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ddCPI</td>
<td style="text-align: right;">-6.05</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">ddunemprate</td>
<td style="text-align: right;">-6.49</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ddstockprice</td>
<td style="text-align: right;">-7.55</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">ddgovexp</td>
<td style="text-align: right;">-8.98</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="methodology" class="level1">
<h1>Methodology</h1>
<p>In this section, the model that this study use to capture the structural relationship between real economy variables and the stock price is introduced. The author use Structural Vector Autoregression (SVAR) model which comprises of 6 variables, <em>cashrate</em>, <em>realgdp</em>, <em>inflation</em>, <em>unemprate</em>, <em>stockprice</em>, and <em>govexp</em>. Subsequently, the model will be used to analyze the impulse responses.</p>
<p>The <strong>SVAR model</strong> can be shown as follows.</p>
<span class="math display">\[\begin{align}
B_0y_t &amp;= b_0 + \sum_{i=1}^{p}B_{i}y_{t-i}+u_t  \\
u_t|Y_{t-1}&amp;\sim iid \mathcal{N} (0_N,I_N)
\end{align}\]</span>
<p>where :</p>
<p><span class="math inline">\(y_{t}\)</span> is <span class="math inline">\(N\times1\)</span> vector of endogenous variables at time t</p>
<p><span class="math inline">\(B_0\)</span> is <span class="math inline">\(N\times N\)</span> structural matrix which captures the contemporaneous relationships between variables</p>
<p><span class="math inline">\(u_t\)</span> is <span class="math inline">\(N\times1\)</span> vector of conditionally on <span class="math inline">\(Y_{t-1}\)</span> orthogonal or independent structural shocks</p>
<p><br></p>
<p>Specifically, <span class="math inline">\(y_{t}\)</span> contains 6 variables as follows. <span class="math display">\[
y_t = \begin{bmatrix}
\text{cashrate} \\
\text{realgdp} \\
\text{CPI} \\
\text{unemprate} \\
\text{stockprice} \\
\text{govexp}
\end{bmatrix}
\]</span></p>
<p>The <strong>reduced form</strong> can be shown as follows.</p>
<span class="math display">\[\begin{align}
y_t &amp;= \mu_0 + \sum_{i=1}^{p}A_{i}y_{t-i}+\epsilon_t \\
\epsilon_t|Y_{t-1} &amp;\sim iid \mathcal{N}(0_N,\Sigma)
\end{align}\]</span>
<p>where :</p>
<p><span class="math inline">\(A_i\)</span> is <span class="math inline">\(N\times N\)</span> matrix of autoregressive slope parameters</p>
<p><span class="math inline">\(\mu_0\)</span> is <span class="math inline">\(N\times1\)</span> vector of constant terms</p>
<p><span class="math inline">\(\epsilon_t\)</span> is <span class="math inline">\(N\times1\)</span> vector of error terms - a multivariate white noise process</p>
<p><span class="math inline">\(\Sigma\)</span> is <span class="math inline">\(N\times N\)</span> covariance matrix of the error term</p>
</section>
<section id="estimation-algorithm-with-simulated-data" class="level1">
<h1>Estimation algorithm with simulated data</h1>
<section id="the-baseline-model" class="level2">
<h2 class="anchored" data-anchor-id="the-baseline-model">The baseline model</h2>
<section id="estimation-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="estimation-algorithm">Estimation algorithm</h3>
<p>The reduced form above can be rewrite in the matrix form as follows:</p>
<span class="math display">\[\begin{align}
Y &amp;= XA + E \\
E|X &amp;\sim \mathcal{MN}_{T \times N}(0,\Sigma,I_T)
\end{align}\]</span>
<p>Bayes’ rule is employed for deriving the posterior distribution</p>
<p>From Bayes’ rule:</p>
<span class="math display">\[\begin{align}
P(A,\Sigma|Y,X) &amp;\propto L(A,\Sigma|Y,X)P(A,\Sigma) \\
\underbrace{P(A,\Sigma|Y,X)}_{\text{Posterior distribution}} &amp;\propto \underbrace{L(A,\Sigma|Y,X)}_{\text{Likelihood}} \underbrace{P(A|\Sigma)P(\Sigma)}_{\text{Prior distribution}}
\end{align}\]</span>
<p><br></p>
<section id="the-likelihood-fuction" class="level4">
<h4 class="anchored" data-anchor-id="the-likelihood-fuction">The likelihood fuction</h4>
<p>The derivation of the likelihood function can be shown in matrix-variate normal distribution as follows:</p>
<span class="math display">\[\begin{align}
L(A,\Sigma|Y,X) = (2\pi)^{-\frac{NT}{2}} det(\Sigma)^{-\frac{T}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(Y-XA)'(Y-XA) \right] \right\} \\
\end{align}\]</span>
<p>Then, the <span class="math inline">\(\hat{A}\)</span> and <span class="math inline">\(\hat{\Sigma}\)</span> corresponding to the maximum likelihood are</p>
<span class="math display">\[\begin{align}
\hat{A} &amp;= (X'X)^{-1}X'Y \\
\hat{\Sigma} &amp;= \frac{1}{T} (Y-X \hat{A})'(Y-X \hat{A})
\end{align}\]</span>
<p>The likelihood function can be represented as Normal inverse Wishart distribution</p>
<span class="math display">\[\begin{align}
L(A,\Sigma|Y,X) &amp;\propto det(\Sigma)^{-\frac{T}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\hat{A})'X'X(Y-\hat{A}) \right] \right\}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(Y-X\hat{A})'(Y-X\hat{A}) \right] \right\} \\
\end{align}\]</span>
<p><br></p>
</section>
<section id="the-prior-distribution" class="level4">
<h4 class="anchored" data-anchor-id="the-prior-distribution">The prior distribution</h4>
<span class="math display">\[\begin{align}
P(A,\Sigma) &amp;= P(A|\Sigma) P(\Sigma) \\
A|\Sigma &amp;\sim \mathcal{MN}_{K \times N} (\underline{A}, \Sigma , \underline{V}) \\
\Sigma &amp;\sim \mathcal{IW}_{N}(\underline{S},\underline{\nu})
\end{align}\]</span>
<p>The prior which follows Normal inverse Wishart distribution:</p>
<span class="math display">\[\begin{align}
p(A,\Sigma) &amp;\propto det(\Sigma)^{-\frac{N+K+\underline{\nu}+1}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\underline{A})'\underline{V}^{-1}(A-\underline{A}) \right] \right\}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}\underline{S} \right] \right\}
\\
\end{align}\]</span>
<p>The Minnesota prior used as prior of the model, the parameters are follows:</p>
<span class="math display">\[\begin{align}
\underline{A} &amp;= [0_{N \times 1} \quad I_N \quad 0_{N \times (p-1)N}]' \\
Var[vec(A)] &amp;= \Sigma \otimes  \underline{V} \\
\underline{V} &amp;= \text{diag}([\kappa_2 \quad \kappa_1 (p^{-2} \otimes \imath_N)]) \\
\end{align}\]</span>
<p>where:</p>
<p><span class="math inline">\(p\)</span> = [1,2,…,p]</p>
<p><span class="math inline">\(\imath_N\)</span> = [1,…,1]</p>
<p><span class="math inline">\(\kappa_1\)</span> is overall shrinkage level for autoregressive slopes, the common value is <span class="math inline">\(0.02^{2}\)</span></p>
<p><span class="math inline">\(\kappa_2\)</span> is overall shrinkage level for the constant term, the common value is <span class="math inline">\(100\)</span></p>
<p>This can be represented in code as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Prior.Dist  <span class="ot">&lt;-</span> <span class="cf">function</span> (N,p,Sigma.hat,kappa<span class="fl">.1</span>,kappa<span class="fl">.2</span>) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  K                 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> N<span class="sc">*</span>p </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  A.prior           <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,K,N)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  A.prior[<span class="dv">2</span><span class="sc">:</span>(N<span class="sc">+</span><span class="dv">1</span>),] <span class="ot">&lt;-</span> <span class="fu">diag</span>(N) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  V.prior           <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">c</span>(kappa<span class="fl">.2</span>,kappa<span class="fl">.1</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,N)))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  S.prior           <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">diag</span>(Sigma.hat))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  nu.prior          <span class="ot">&lt;-</span> N<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">list</span>(<span class="at">A.prior  =</span> A.prior,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">V.prior  =</span> V.prior,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">S.prior  =</span> S.prior,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">nu.prior =</span> nu.prior))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</section>
<section id="the-posterior-distribution" class="level4">
<h4 class="anchored" data-anchor-id="the-posterior-distribution">The posterior distribution</h4>
<p>From the Bayes’ rule mentioned above, the posterior distribution as follows:</p>
<span class="math display">\[\begin{align}
P(A,\Sigma|Y,X) \propto &amp; L(A,\Sigma|Y,X)P(A,\Sigma) \\
P(A,\Sigma|Y,X) \propto
&amp; det(\Sigma)^{-\frac{T}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\hat{A})'X'X(A-\hat{A}) \right] \right\}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(Y-X\hat{A})'(Y-X\hat{A}) \right] \right\} \\
&amp;det(\Sigma)^{-\frac{N+K+\underline{\nu}+1}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\underline{A})'\underline{V}^{-1}(A-\underline{A}) \right] \right\}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}\underline{S} \right] \right\} \\
P(A,\Sigma|Y,X) \propto
&amp; det(\Sigma)^{-\frac{T+N+K+\underline{\nu}+1}{2}}
exp \left\{-\frac{1}{2} tr \left[
\Sigma^{-1}\left[(A-\hat{A})'X'X(A-\hat{A}) + (A-\underline{A})'\underline{V}^{-1}(A-\underline{A}) \\
+(Y-X\hat{A})'(Y-X\hat{A})+\underline{S})\right] \right] \right\}

\\

\end{align}\]</span>
<p>Which can represented in form of Normal inverse Wishart distribution</p>
<span class="math display">\[\begin{align}
P(A,\Sigma|Y,X) &amp;= P(A|Y,X,\Sigma) P(\Sigma|Y,X) \\
P(A|Y,X,\Sigma) &amp;\sim \mathcal{MN}_{K \times N} (\overline{A}, \Sigma , \overline{V}) \\
P(\Sigma|Y,X) &amp;\sim \mathcal{IW}_{N}(\overline{S},\overline{\nu})
\end{align}\]</span>
<p><br> And the posterior parameters are structured as follows.</p>
<span class="math display">\[\begin{align}

\overline{V} &amp;= (X'X+ \underline{V}^{-1})^{-1} \\
\overline{A} &amp;= \overline{V}(X'Y+\underline{V}^{-1} \underline{A})\\
\overline{\nu} &amp;= T+\underline{\nu}\\
\overline{S} &amp;= \underline{S}+Y'Y + \underline{A}'\underline{V}^{-1}\underline{A} -
\overline{A}'\overline{V}^{-1}\overline{A} \\

\end{align}\]</span>
<p>This can be represented in code as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Post.Dist <span class="ot">&lt;-</span> <span class="cf">function</span> (X,Y,prior.parameters) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  A.prior     <span class="ot">&lt;-</span> prior.parameters<span class="sc">$</span>A.prior</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  V.prior     <span class="ot">&lt;-</span> prior.parameters<span class="sc">$</span>V.prior</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  S.prior     <span class="ot">&lt;-</span> prior.parameters<span class="sc">$</span>S.prior</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  nu.prior    <span class="ot">&lt;-</span> prior.parameters<span class="sc">$</span>nu.prior</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  V.bar.inv   <span class="ot">&lt;-</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  V.bar       <span class="ot">&lt;-</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  A.bar       <span class="ot">&lt;-</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  nu.bar      <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Y) <span class="sc">+</span> nu.prior</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  S.bar       <span class="ot">&lt;-</span> S.prior <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  S.bar.inv   <span class="ot">&lt;-</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">list</span>(<span class="at">V.bar      =</span> V.bar,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">A.bar      =</span> A.bar,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">nu.bar     =</span> nu.bar,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">S.bar      =</span> S.bar,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">S.bar.inv  =</span> S.bar.inv,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">V.bar.inv  =</span> V.bar.inv))</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The draws from the posterior distribution can be represented in code as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Post.Draw <span class="ot">&lt;-</span> <span class="cf">function</span> (N,S,p,posterior.parameters){</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  K <span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>N<span class="sc">*</span>p</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  A.bar               <span class="ot">&lt;-</span> posterior.parameters<span class="sc">$</span>A.bar</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  V.bar               <span class="ot">&lt;-</span> posterior.parameters<span class="sc">$</span>V.bar</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  S.bar               <span class="ot">&lt;-</span> posterior.parameters<span class="sc">$</span>S.bar</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  nu.bar              <span class="ot">&lt;-</span> posterior.parameters<span class="sc">$</span>nu.bar</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  S.bar.inv           <span class="ot">&lt;-</span> posterior.parameters<span class="sc">$</span>S.bar.inv</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior     <span class="ot">&lt;-</span> <span class="fu">rWishart</span>(S, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span>S.bar.inv)  </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior     <span class="ot">&lt;-</span> <span class="fu">apply</span>(Sigma.posterior,<span class="dv">3</span>,solve)            </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior     <span class="ot">&lt;-</span> <span class="fu">array</span>(Sigma.posterior,<span class="fu">c</span>(N,N,S))   </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  A.posterior         <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),S))),<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),S)) </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  B0.tilde            <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  L                   <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar)) </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  Bplus.tilde         <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,K,S))</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    cholSigma.s       <span class="ot">&lt;-</span> <span class="fu">chol</span>(Sigma.posterior[,,s])</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    B0.tilde[,,s]     <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(cholSigma.s)) </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    A.posterior[,,s]  <span class="ot">&lt;-</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.posterior[,,s]<span class="sc">%*%</span>cholSigma.s </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    Bplus.tilde[,,s]  <span class="ot">&lt;-</span> B0.tilde[,,s]<span class="sc">%*%</span><span class="fu">t</span>(A.posterior[,,s])</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">A.posterior     =</span> A.posterior,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">B0.tilde        =</span> B0.tilde,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">Bplus.tilde     =</span> Bplus.tilde,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">Sigma.posterior =</span> Sigma.posterior)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</section>
</section>
<section id="data-simulation" class="level3">
<h3 class="anchored" data-anchor-id="data-simulation">Data simulation</h3>
<p>The author generates 1,000 observations from bi-variate Gaussian random walk process to prove that the algorithm works.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/plot random walk-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-5-the-simulation-data-1000-observations" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-5-the-simulation-data-1000-observations">Figure 5: The simulation data (1,000 observations)</h5>
</section>
<p>The target model for estimation is a Sign-Restricted Structural Vector Autoregression (SVAR).</p>
<span class="math display">\[\begin{align}
B_0y_t &amp;= b_0 + \sum_{i=1}^{p}B_{1}y_{t-1}+u_t  \\
u_t|Y_{t-1}&amp;\sim iid \mathcal{N} (0_N,I_N)
\end{align}\]</span>
<p>The author randomly draws matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(\Sigma\)</span> from the posterior distribution, which is specified as a Normal Inverse Wishart distribution as described earlier. Following this, the sign restriction is applied to the main diagonal of matrix <span class="math inline">\(B_{0}\)</span>, ensuring positive signs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ImposeSignRestriction <span class="ot">&lt;-</span> <span class="cf">function</span> (restrictions,N,p,posterior.draws){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  A.posterior         <span class="ot">&lt;-</span> posterior.draws<span class="sc">$</span>A.posterior</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior     <span class="ot">&lt;-</span> posterior.draws<span class="sc">$</span>Sigma.posterior</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  B0.tilde            <span class="ot">&lt;-</span> posterior.draws<span class="sc">$</span>B0.tilde</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  Bplus.tilde         <span class="ot">&lt;-</span> posterior.draws<span class="sc">$</span>Bplus.tilde</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  S                   <span class="ot">&lt;-</span> <span class="fu">dim</span>(A.posterior)[<span class="dv">3</span>]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  B0.store            <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  Bplus.store         <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,K,S))</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  i.vec <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    B0.tilde1         <span class="ot">&lt;-</span> B0.tilde[,,s]</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    Bplus.tilde1      <span class="ot">&lt;-</span> Bplus.tilde[,,s]</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    sign.restrictions.do.not.hold <span class="ot">=</span> <span class="cn">TRUE</span> </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (sign.restrictions.do.not.hold){</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    X                 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(N<span class="sc">*</span>N),N,N)         </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    QR                <span class="ot">&lt;-</span> <span class="fu">qr</span>(X, <span class="at">tol =</span> <span class="fl">1e-10</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    Q                 <span class="ot">&lt;-</span> <span class="fu">qr.Q</span>(QR,<span class="at">complete=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    R                 <span class="ot">&lt;-</span> <span class="fu">qr.R</span>(QR,<span class="at">complete=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    Q                 <span class="ot">&lt;-</span> <span class="fu">t</span>(Q <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="fu">sign</span>(<span class="fu">diag</span>(R))))</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    B0                <span class="ot">&lt;-</span> Q<span class="sc">%*%</span>B0.tilde1                   </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    Bplus             <span class="ot">&lt;-</span> Q<span class="sc">%*%</span>Bplus.tilde1                  </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    B0.inv            <span class="ot">&lt;-</span> <span class="fu">solve</span>(B0)      </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    check             <span class="ot">&lt;-</span> <span class="fu">all</span>(<span class="fu">diag</span>(B0)<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (check){sign.restrictions.do.not.hold<span class="ot">=</span><span class="cn">FALSE</span>}</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span> </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    i.vec             <span class="ot">&lt;-</span> <span class="fu">c</span>(i.vec,i) </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    B0.store[,,s]     <span class="ot">&lt;-</span> B0</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    Bplus.store[,,s]  <span class="ot">&lt;-</span> Bplus</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">list</span>(<span class="at">B0.store    =</span> B0.store,</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>               <span class="at">Bplus.store =</span> Bplus.store,</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>               <span class="at">i           =</span> i.vec))</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Table 5 shows that the mean values of matrix <span class="math inline">\(A\)</span> at <span class="math inline">\(A_{11}\)</span> and <span class="math inline">\(A_{22}\)</span> are close to 1, while the constant term in the first row is nearly zero. Additionally, the variance-covariance matrix in Table 6 is approximately an identity matrix. These findings are consistent with our bi-variate Gaussian random walk process.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 5: Mean of the matrix A (The baseline model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">RW1</th>
<th style="text-align: right;">RW2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cons</td>
<td style="text-align: right;">0.0541001</td>
<td style="text-align: right;">0.0168892</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lag1</td>
<td style="text-align: right;">0.9939796</td>
<td style="text-align: right;">0.0073920</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lag2</td>
<td style="text-align: right;">0.0008390</td>
<td style="text-align: right;">0.9946839</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 6: Mean of the variance-covariance matrix (The baseline model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">RW1</th>
<th style="text-align: right;">RW2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.9629585</td>
<td style="text-align: right;">-0.0117865</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">-0.0117865</td>
<td style="text-align: right;">0.9409945</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<p>Table 7 displays that the mean values of the main diagonal elements in matrix <span class="math inline">\(B_{0}\)</span> are positive, providing evidence for the validity of the imposed restriction.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 7: Mean of the matrix B0 (The baseline model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.6523449</td>
<td style="text-align: right;">0.0008668</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">0.0164861</td>
<td style="text-align: right;">0.6602365</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In Table 8 which displays the mean of matrix <span class="math inline">\(B_{+}\)</span>, the values in the first column, representing the constant term in the equation, are close to zero.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 8: Mean of the matrix B+ (The baseline model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
<th style="text-align: right;">C3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.0350624</td>
<td style="text-align: right;">0.6484145</td>
<td style="text-align: right;">0.0014121</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">0.0120368</td>
<td style="text-align: right;">0.0212601</td>
<td style="text-align: right;">0.6567357</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="the-extension-model" class="level2">
<h2 class="anchored" data-anchor-id="the-extension-model">The extension model</h2>
<section id="estimation-algorithm-1" class="level3">
<h3 class="anchored" data-anchor-id="estimation-algorithm-1">Estimation algorithm</h3>
<p>Suppose the author aims to enhance the flexibility of the prior distribution for gamma (<span class="math inline">\(\gamma\)</span>) by modeling it in the following manner.</p>
<span class="math display">\[\begin{align}
\color{Grey}P(A,\Sigma\color{Black}|\gamma) &amp;= \color{Grey}P(A|\Sigma) P(\Sigma\color{Black}|\gamma) \\
\color{Grey}A|\Sigma &amp;\sim \color{Grey}\mathcal{MN}_{K \times N} \color{Grey}(\underline{A}, \Sigma , \underline{V}) \\
\color{Black}\Sigma|\gamma &amp;\sim \mathcal{IW}_{N}(\gamma I_{N},\underline{\nu}) \\
\gamma &amp;\sim \mathcal{IG2} (\underline{S},\underline{\nu})
\end{align}\]</span>
<p>Thus, the the posterior distribution as follows:</p>
<span class="math display">\[\begin{align}
P(A,\Sigma|Y,X,\gamma) \propto &amp; L(A,\Sigma|Y,X,\gamma)P(A,\Sigma) \\
P(A,\Sigma|Y,X,\gamma) \propto &amp; L(A,\Sigma|Y,X,\gamma)P(A|\Sigma) P(\Sigma|\gamma) \\
P(A,\Sigma|Y,X,\gamma) \propto
&amp; det(\Sigma)^{-\frac{T}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\hat{A})'X'X(A-\hat{A}) \right] \right\}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(Y-X\hat{A})'(Y-X\hat{A}) \right] \right\} \\
&amp;det(\Sigma)^{-\frac{N+K+\underline{\nu}+1}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\underline{A})'\underline{V}^{-1}(A-\underline{A}) \right] \right\}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}\gamma I_{N} \right] \right\} \\
P(A,\Sigma|Y,X,\gamma) \propto
&amp; det(\Sigma)^{-\frac{T+N+K+\underline{\nu}+1}{2}}
exp \left\{-\frac{1}{2} tr \left[
\Sigma^{-1}\left[(A-\hat{A})'X'X(A-\hat{A}) + (A-\underline{A})'\underline{V}^{-1}(A-\underline{A}) \\
+(Y-X\hat{A})'(Y-X\hat{A})+\gamma I_{N}\right] \right] \right\} \\

\end{align}\]</span>
<p>The distribution represented in the form of Normal Inverse Wishart is characterized by the following parameters:</p>
<span class="math display">\[\begin{align}

\overline{V} &amp;= (X'X+ \underline{V}^{-1})^{-1} \\
\overline{A} &amp;= \overline{V}(X'Y+\underline{V}^{-1} \underline{A})\\
\overline{\nu} &amp;= T+\underline{\nu}\\
\overline{S} &amp;= \gamma I_{N}+Y'Y + \underline{A}'\underline{V}^{-1}\underline{A} -
\overline{A}'\overline{V}^{-1}\overline{A} \\

\end{align}\]</span>
<p><br></p>
<p>The posterior distribution of <span class="math inline">\(\gamma\)</span> is also needed as it serves as a crucial component for the sampling procedure.</p>
<span class="math display">\[\begin{align}
P(\gamma|A,\Sigma,Y,X) \propto &amp; L(Y|\Sigma,X,A)P(\gamma)P(A,\Sigma)P(\Sigma|\gamma) \\
\propto &amp; P(\gamma)P(\Sigma|\gamma) \\

= &amp; \gamma^{-\frac{\underline{\nu}+2}{2}}\:exp\left\{{-\frac{1}{2}\frac{\underline{S}}{\lambda}} \right\} \:det(\gamma I_{N})^{\frac{\underline{\nu}}{2}}\:det(\Sigma)^{-\frac{\underline{\nu}+N+1}{2}}\:exp\left\{{-\frac{1}{2}tr[\Sigma^{-1}\gamma I_{N}]} \right\} \\

= &amp;\gamma^{-\frac{\underline{\nu}+2}{2}}\:exp\left\{{-\frac{1}{2}\frac{\underline{S}}{\gamma}} \right\}\:\gamma^{-\frac{N\underline{\nu}}{2}}\:det(\Sigma)^{\frac{\underline{\nu}+N+1}{2}}\:exp\left\{{-\frac{1}{2}\gamma \:tr[\Sigma^{-1}]} \right\} \\

\propto &amp;\gamma^{\frac{N\underline{\nu}-\underline{\nu}}{2}-1} \:
exp\left\{{-\frac{1}{2}}[\gamma\:tr[\Sigma^{-1}]+{\frac{\underline{S}}{\gamma}}]\right\} \\

\end{align}\]</span>
<p>The following distribution conforms to the Generalized Inverse Gaussian (GIG) distribution, with the parameters as follows:</p>
<span class="math display">\[\begin{align}
\lambda = {\frac{N\underline{\nu}-\underline{\nu}}{2}} \\

\\ \chi = \underline{S}\\

\\ \psi = tr[\Sigma^{-1}]
\end{align}\]</span>
<p>The Gibbs Sampler is used to get the posterior draws of the extended model</p>
<p>For <span class="math inline">\(S_{1} = 1,000\)</span> and <span class="math inline">\(S_{2} = 9,000\)</span></p>
<p>Initialize <span class="math inline">\(\gamma\)</span> at <span class="math inline">\(\gamma^{(0)}\)</span></p>
<p>At each iteration:</p>
<ol type="1">
<li>Draw <span class="math inline">\(\Sigma^{(s)} \sim P(\Sigma|Y,X,\gamma^{(s-1)})\)</span></li>
<li>Draw <span class="math inline">\(A^{(s)}\sim P(A|\Sigma^{(s)},Y,X)\)</span></li>
<li>Draw <span class="math inline">\(\gamma^{(s)} \sim P(\gamma|Y,X,A^{(s)},\Sigma^{(s)})\)</span></li>
</ol>
<p>Repeat steps 1 to 3 for <span class="math inline">\(S_{1}\)</span> + <span class="math inline">\(S_{2}\)</span> iterations</p>
<p>Discard the first <span class="math inline">\(S_{1}\)</span> iterations to allow the algorithm to converge to the stationary state.</p>
<p>The author then utilizes the random draws from <span class="math inline">\(\Sigma^{(s)}, A^{(s)}, \gamma^{(s)}\)</span> to obtain the posterior draw and create the following <span class="math inline">\(B_{0}\)</span> and <span class="math inline">\(B_{+}\)</span> matrices.</p>
<p>This can be represented in code as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Gibbsampler.Extension <span class="ot">&lt;-</span> <span class="cf">function</span>(Y, prior.parameters, posterior.parameters, S1, S2, N, K) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  A.prior             <span class="ot">&lt;-</span> prior.parameters<span class="sc">$</span>A.prior</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  V.prior             <span class="ot">&lt;-</span> prior.parameters<span class="sc">$</span>V.prior</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  nu.prior            <span class="ot">&lt;-</span> prior.parameters<span class="sc">$</span>nu.prior</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  S.prior             <span class="ot">&lt;-</span> prior.parameters<span class="sc">$</span>S.prior</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  A.bar               <span class="ot">&lt;-</span> posterior.parameters<span class="sc">$</span>A.bar</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  V.bar               <span class="ot">&lt;-</span> posterior.parameters<span class="sc">$</span>V.bar</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  V.bar.inv           <span class="ot">&lt;-</span> posterior.parameters<span class="sc">$</span>V.bar.inv</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  nu.bar              <span class="ot">&lt;-</span> posterior.parameters<span class="sc">$</span>nu.bar</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize variables</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  S.bar               <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim =</span> <span class="fu">c</span>(N, N, (S1<span class="sc">+</span>S2)))</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  S.bar.inv           <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim =</span> <span class="fu">c</span>(N, N, (S1<span class="sc">+</span>S2)))</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  gamma.store         <span class="ot">&lt;-</span> <span class="fu">numeric</span>(S1<span class="sc">+</span>S2)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  gamma.store[<span class="dv">1</span>]      <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  A.posterior         <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim =</span> <span class="fu">c</span>(K, N, (S1<span class="sc">+</span>S2)))</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  B0.tilde            <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim =</span> <span class="fu">c</span>(N, N, (S1<span class="sc">+</span>S2)))</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  Bplus.tilde         <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim =</span> <span class="fu">c</span>(N, K, (S1<span class="sc">+</span>S2)))</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  Sigma.store         <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim =</span> <span class="fu">c</span>(N, N, (S1<span class="sc">+</span>S2)))</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  i.vec <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(S1<span class="sc">+</span>S2)) {</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate S.bar</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    S.bar[,,i]        <span class="ot">&lt;-</span> gamma.store[i] <span class="sc">*</span> <span class="fu">diag</span>(N) <span class="sc">+</span> <span class="fu">t</span>(Y) <span class="sc">%*%</span> Y <span class="sc">+</span> <span class="fu">t</span>(A.prior) <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior)) <span class="sc">%*%</span> A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar) <span class="sc">%*%</span> V.bar.inv <span class="sc">%*%</span> A.bar</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    S.bar.inv[,,i]    <span class="ot">&lt;-</span> <span class="fu">solve</span>(S.bar[,,i])</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate posterior samples using rWishart</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior   <span class="ot">&lt;-</span> <span class="fu">rWishart</span>(<span class="dv">1</span>, <span class="at">df =</span> nu.bar, <span class="at">Sigma =</span> S.bar.inv[,,i])</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior   <span class="ot">&lt;-</span> <span class="fu">apply</span>(Sigma.posterior, <span class="dv">3</span>, solve)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior   <span class="ot">&lt;-</span> <span class="fu">array</span>(Sigma.posterior, <span class="fu">c</span>(N, N, <span class="dv">1</span>))</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    Sigma.store[,,i]  <span class="ot">&lt;-</span> Sigma.posterior[,,<span class="dv">1</span>]</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    cholSigma.s       <span class="ot">&lt;-</span> <span class="fu">chol</span>(Sigma.posterior[,,<span class="dv">1</span>])</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    L                 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar)) </span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    A.posterior[,,i]  <span class="ot">&lt;-</span> A.bar <span class="sc">+</span> L <span class="sc">%*%</span> A.posterior[,,i] <span class="sc">%*%</span> cholSigma.s</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute lambda, chi, and psi</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    lambda            <span class="ot">&lt;-</span> ((nu.prior <span class="sc">*</span> N) <span class="sc">-</span> nu.prior) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    chi               <span class="ot">&lt;-</span> S.prior</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    psi               <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(Sigma.posterior[,,<span class="dv">1</span>])))</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate gamma using rgig</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    gamma.store[i]    <span class="ot">&lt;-</span> GIGrvg<span class="sc">::</span><span class="fu">rgig</span>(<span class="at">n =</span> <span class="dv">1</span>, lambda, chi, psi)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update B0.tilde and Bplus.tilde</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    B0.tilde[,,i]     <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(cholSigma.s))</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    Bplus.tilde[,,i]  <span class="ot">&lt;-</span> B0.tilde[,,i] <span class="sc">%*%</span> <span class="fu">t</span>(A.posterior[,,i])</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">A.posterior      =</span> A.posterior[,,S1<span class="sc">:</span>(S1<span class="sc">+</span>S2)],</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>               <span class="at">gamma.store     =</span> gamma.store[S1<span class="sc">:</span>(S1<span class="sc">+</span>S2)],</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>               <span class="at">B0.tilde        =</span> B0.tilde[,,S1<span class="sc">:</span>(S1<span class="sc">+</span>S2)],</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>               <span class="at">Bplus.tilde     =</span> Bplus.tilde[,,S1<span class="sc">:</span>(S1<span class="sc">+</span>S2)],</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>               <span class="at">Sigma.posterior =</span> Sigma.store[,,S1<span class="sc">:</span>(S1<span class="sc">+</span>S2)],</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>               <span class="at">i               =</span> i.vec))</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-simulation-1" class="level3">
<h3 class="anchored" data-anchor-id="data-simulation-1">Data simulation</h3>
<p>Table 9 shows that the mean values of matrix <span class="math inline">\(A\)</span> and the variance-covariance matrix in Table 10 exhibit behavior similar to that of the basic model.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 9: Mean of the matrix A (The extension model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">RW1</th>
<th style="text-align: right;">RW2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cons</td>
<td style="text-align: right;">0.0538050</td>
<td style="text-align: right;">0.0170952</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lag1</td>
<td style="text-align: right;">0.9939738</td>
<td style="text-align: right;">0.0073219</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lag2</td>
<td style="text-align: right;">0.0008760</td>
<td style="text-align: right;">0.9946915</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 10: Mean of the variance-covariance matrix (The extension model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">RW1</th>
<th style="text-align: right;">RW2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.9620004</td>
<td style="text-align: right;">-0.0124727</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">-0.0124727</td>
<td style="text-align: right;">0.9422852</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<p>Table 11 indicates that the mean value of the main diagonal of <span class="math inline">\(B_{0}\)</span> remains positive, exhibiting a similar behavior to that of the basic model.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 11: Mean of the matrix B0 (The extension model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.6456414</td>
<td style="text-align: right;">0.0102519</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">0.0078336</td>
<td style="text-align: right;">0.6525126</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In Table 12 which displays the mean of matrix <span class="math inline">\(B_{+}\)</span>, the values in the first column, representing the constant term in the equation, are close to zero and exhibit a behavior similar to that of the basic model.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 12: Mean of the matrix B+ (The extension model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
<th style="text-align: right;">C3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.0349140</td>
<td style="text-align: right;">0.6418257</td>
<td style="text-align: right;">0.0107630</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">0.0115763</td>
<td style="text-align: right;">0.0125640</td>
<td style="text-align: right;">0.6490555</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The mean of <span class="math inline">\(\gamma\)</span> is equal 1.8067 and the trace plot and histogram shown in Figure 6.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-6-the-plot-and-histogram-of-gamma-the-extension-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-6-the-plot-and-histogram-of-gamma-the-extension-model">Figure 6: The plot and histogram of gamma (The extension model)</h5>
</section>
<p><br></p>
</section>
</section>
<section id="stochastic-volatility-heteroskedasticity" class="level2">
<h2 class="anchored" data-anchor-id="stochastic-volatility-heteroskedasticity">Stochastic Volatility Heteroskedasticity</h2>
<section id="estimation-algorithm-2" class="level3">
<h3 class="anchored" data-anchor-id="estimation-algorithm-2">Estimation algorithm</h3>
<p>Next, the author will estimate the model with stochastic volatility. This approach allows for the capture of time-varying volatility in the data. The model will be applied to both the baseline model and the extension model.</p>
<p>The reduced form above can be rewrite in the matrix form as follows:</p>
<span class="math display">\[\begin{align}
Y &amp;= XA + E \\
E|X &amp;\sim \mathcal{MN}_{T \times N}(0,\Sigma,diag(\sigma^{2}))
\end{align}\]</span>
<p>Where <span class="math inline">\(\sigma^{2} = (exp\{h_{1}\},exp\{h_{2}\},\cdots, exp\{h_{T}\})\)</span> which is a vector of conditional heteroskedasticity variables and <span class="math inline">\(h_{t}\)</span> follows a stochastic volatility process.</p>
<p>Thus, the likelihood can be rewrite as</p>
<span class="math display">\[\begin{align}
L(A,\Sigma|Y,X,\sigma^{2}) \propto det(diag(\sigma^{2}))^{-\frac{N}{2}} det(\Sigma)^{-\frac{T}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(Y-XA)'(diag(\sigma^{2}))^{-1}(Y-XA) \right] \right\} \\
\end{align}\]</span>
<section id="the-baseline-model-1" class="level4">
<h4 class="anchored" data-anchor-id="the-baseline-model-1"><strong>The baseline model</strong></h4>
<p>The full conditional posterior for the baseline model is in the form of a Normal Inverse Wishart distribution, with posterior parameters structured as follows.</p>
<span class="math display">\[\begin{align}

\overline{V} &amp;= (X'(diag(\sigma^{2})^{-1}X+ \underline{V}^{-1})^{-1} \\
\overline{A} &amp;= \overline{V}(X'(diag(\sigma^{2})^{-1}Y+\underline{V}^{-1} \underline{A})\\
\overline{\nu} &amp;= T+\underline{\nu}\\
\overline{S} &amp;= \underline{S}+Y'(diag(\sigma^{2})^{-1}Y + \underline{A}'\underline{V}^{-1}\underline{A} -
\overline{A}'\overline{V}^{-1}\overline{A} \\

\end{align}\]</span>
<p>The Gibbs Sampler is used to get the posterior draws of the stochastic volatility model.</p>
<p>For <span class="math inline">\(S_{1} = 1,000\)</span> and <span class="math inline">\(S_{2} = 9,000\)</span></p>
<p>Initialize <span class="math inline">\(\sigma^{2}\)</span> at <span class="math inline">\(\sigma^{2^{(0)}}\)</span></p>
<p>At each iteration s:</p>
<ol type="1">
<li>Draw <span class="math inline">\((A,\Sigma)^{(s)} \sim P(A,\Sigma|Y,X,\sigma^{2^{(s-1)}})\)</span></li>
<li>Draw <span class="math inline">\(\sigma^{2^{(s)}} \sim P(\sigma^{2}|Y,X,A^{(s)},\Sigma^{(s)})\)</span></li>
</ol>
<p>Repeat step 1 and 2 for <span class="math inline">\((S_{1} + S_{2})\)</span> times, then discard the first <span class="math inline">\(S_{1}\)</span> iterations to allow the algorithm to converge to the equilibrium state.</p>
<p>The function for drawing <span class="math inline">\(\sigma^{2^{(s)}} \sim P(\sigma^{2}|Y,X,A^{(s)},\Sigma^{(s)})\)</span> is as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>SVcommon.Gibbs.iteration <span class="ot">=</span> <span class="cf">function</span>(aux, priors){</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># A single iteration of the Gibbs sampler for the SV component</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># aux is a list containing:</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   Y - a TxN matrix</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   X - a TxK matrix</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   H - a Tx1 matrix</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   h0 - a scalar</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   sigma.v2 - a scalar</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   s - a Tx1 matrix</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   A - a KxN matrix</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   Sigma - an NxN matrix</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   sigma2 - a Tx1 matrix</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># priors is a list containing:</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   h0.v - a positive scalar</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   h0.m - a scalar</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   sigmav.s - a positive scalar</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   sigmav.nu - a positive scalar</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   HH - a TxT matrix</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  T             <span class="ot">&lt;-</span> <span class="fu">dim</span>(aux<span class="sc">$</span>Y)[<span class="dv">1</span>]</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  N             <span class="ot">&lt;-</span> <span class="fu">dim</span>(aux<span class="sc">$</span>Y)[<span class="dv">2</span>]</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  alpha.st      <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.92677</span>,<span class="fl">1.34744</span>,<span class="fl">0.73504</span>,<span class="fl">0.02266</span>,<span class="dv">0</span><span class="fl">-0.85173</span>,<span class="sc">-</span><span class="fl">1.97278</span>,<span class="sc">-</span><span class="fl">3.46788</span>,<span class="sc">-</span><span class="fl">5.55246</span>,<span class="sc">-</span><span class="fl">8.68384</span>,<span class="sc">-</span><span class="fl">14.65000</span>)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  sigma.st      <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.11265</span>,<span class="fl">0.17788</span>,<span class="fl">0.26768</span>,<span class="fl">0.40611</span>,<span class="fl">0.62699</span>,<span class="fl">0.98583</span>,<span class="fl">1.57469</span>,<span class="fl">2.54498</span>,<span class="fl">4.16591</span>,<span class="fl">7.33342</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  pi.st         <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.00609</span>,<span class="fl">0.04775</span>,<span class="fl">0.13057</span>,<span class="fl">0.20674</span>,<span class="fl">0.22715</span>,<span class="fl">0.18842</span>,<span class="fl">0.12047</span>,<span class="fl">0.05591</span>,<span class="fl">0.01575</span>,<span class="fl">0.00115</span>)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  Lambda        <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">chol</span>(aux<span class="sc">$</span>Sigma))</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  Z             <span class="ot">&lt;-</span> <span class="fu">rowSums</span>((aux<span class="sc">$</span>Y <span class="sc">-</span> aux<span class="sc">$</span>X <span class="sc">%*%</span> aux<span class="sc">$</span>A ) <span class="sc">%*%</span> Lambda) <span class="sc">/</span> <span class="fu">sqrt</span>(N)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  Y.tilde       <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">log</span>((Z <span class="sc">+</span> <span class="fl">0.0000001</span>)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  Ytilde.alpha  <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Y.tilde <span class="sc">-</span> alpha.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)])</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sampling initial condition</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  V.h0.bar      <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>((<span class="dv">1</span> <span class="sc">/</span> priors<span class="sc">$</span>h0.v) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2))</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  m.h0.bar      <span class="ot">&lt;-</span> V.h0.bar<span class="sc">*</span>((priors<span class="sc">$</span>h0.m <span class="sc">/</span> priors<span class="sc">$</span>h0.v) <span class="sc">+</span> (aux<span class="sc">$</span>H[<span class="dv">1</span>] <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2))</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  h0.draw       <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> m.h0.bar, <span class="at">sd =</span> <span class="fu">sqrt</span>(V.h0.bar))</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>h0        <span class="ot">&lt;-</span> h0.draw</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sampling sigma.v2</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  sigma.v2.s    <span class="ot">&lt;-</span> priors<span class="sc">$</span>sigmav.s <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">c</span>(aux<span class="sc">$</span>H[<span class="dv">1</span>] <span class="sc">-</span> aux<span class="sc">$</span>h0, <span class="fu">diff</span>(aux<span class="sc">$</span>H))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>  sigma.v2.draw <span class="ot">&lt;-</span> sigma.v2.s <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, priors<span class="sc">$</span>sigmav.nu <span class="sc">+</span> T)</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>sigma.v2  <span class="ot">&lt;-</span> sigma.v2.draw</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sampling auxiliary states</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>  Pr.tmp        <span class="ot">&lt;-</span> <span class="fu">simplify2array</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="cf">function</span>(x){</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dnorm</span>(Y.tilde, <span class="at">mean =</span> <span class="fu">as.vector</span>(aux<span class="sc">$</span>H <span class="sc">+</span> alpha.st[x]), <span class="at">sd =</span> <span class="fu">sqrt</span>(sigma.st[x]), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">log</span>(pi.st[x])</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>  Pr            <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Pr.tmp, <span class="dv">1</span>, <span class="cf">function</span>(x){<span class="fu">exp</span>(x <span class="sc">-</span> <span class="fu">max</span>(x)) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">exp</span>(x <span class="sc">-</span> <span class="fu">max</span>(x)))}))</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>  s.cum         <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Pr, <span class="dv">1</span>, cumsum))</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>  r             <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">runif</span>(T), <span class="dv">10</span>), <span class="at">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>  ss            <span class="ot">&lt;-</span> <span class="fu">apply</span>(s.cum <span class="sc">&lt;</span> r, <span class="dv">1</span>, sum) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>s         <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(ss)</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sampling log-volatilities using functions for tridiagonal precision matrix</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>  Sigma.s.inv   <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">/</span> sigma.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)])</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>  D.inv         <span class="ot">&lt;-</span> Sigma.s.inv <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2) <span class="sc">*</span> priors<span class="sc">$</span>HH</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>  b             <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Ytilde.alpha <span class="sc">/</span> sigma.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)] <span class="sc">+</span> (aux<span class="sc">$</span>h0<span class="sc">/</span>aux<span class="sc">$</span>sigma.v2)<span class="sc">*</span><span class="fu">diag</span>(T)[,<span class="dv">1</span>])</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>  lead.diag     <span class="ot">&lt;-</span> <span class="fu">diag</span>(D.inv)</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>  sub.diag      <span class="ot">&lt;-</span> mgcv<span class="sc">::</span><span class="fu">sdiag</span>(D.inv, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>  D.chol        <span class="ot">&lt;-</span> mgcv<span class="sc">::</span><span class="fu">trichol</span>(<span class="at">ld =</span> lead.diag, <span class="at">sd =</span> sub.diag)</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>  D.L           <span class="ot">&lt;-</span> <span class="fu">diag</span>(D.chol<span class="sc">$</span>ld)</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>  mgcv<span class="sc">::</span><span class="fu">sdiag</span>(D.L,<span class="sc">-</span><span class="dv">1</span>) <span class="ot">=</span> D.chol<span class="sc">$</span>sd</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>  x             <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rnorm</span>(T))</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>  a             <span class="ot">&lt;-</span> <span class="fu">forwardsolve</span>(D.L, b)</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>  draw          <span class="ot">&lt;-</span> <span class="fu">backsolve</span>(<span class="fu">t</span>(D.L), a <span class="sc">+</span> x)</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>H         <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(draw)</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>sigma2    <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">exp</span>(draw))</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(aux)</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And the function for drawing <span class="math inline">\((A,\Sigma)^{(s)} \sim P(A,\Sigma|Y,X,\sigma^{2^{(s-1)}})\)</span> is as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Post.draws.stochastic <span class="ot">&lt;-</span> <span class="cf">function</span> (Y,X,prior.parameters.stochastic,S1,S2) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  N                     <span class="ot">&lt;-</span> <span class="fu">ncol</span>(Y)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  K                     <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  T                     <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Y)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  A.prior               <span class="ot">&lt;-</span> prior.parameters.stochastic<span class="sc">$</span>A.prior</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  V.prior               <span class="ot">&lt;-</span> prior.parameters.stochastic<span class="sc">$</span>V.prior</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  S.prior               <span class="ot">&lt;-</span> prior.parameters.stochastic<span class="sc">$</span>S.prior</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  nu.prior              <span class="ot">&lt;-</span> prior.parameters.stochastic<span class="sc">$</span>nu.prior</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  A.posterior           <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(K,N,(S1<span class="sc">+</span>S2)))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior       <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,(S1<span class="sc">+</span>S2))) </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  H.posterior           <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(<span class="fu">nrow</span>(Y),(S1<span class="sc">+</span>S2<span class="sc">+</span><span class="dv">1</span>)))  </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  B0.tilde              <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,(S1<span class="sc">+</span>S2)))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  Bplus.tilde           <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,K,(S1<span class="sc">+</span>S2)))</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  H.posterior[,<span class="dv">1</span>]       <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,T,<span class="dv">1</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  HH                    <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">diag</span>(T)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  mgcv<span class="sc">::</span><span class="fu">sdiag</span>(HH,<span class="sc">-</span><span class="dv">1</span>)    <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  mgcv<span class="sc">::</span><span class="fu">sdiag</span>(HH,<span class="dv">1</span>)     <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  priors <span class="ot">=</span> <span class="fu">list</span>(<span class="at">HH       =</span> HH,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">h0.m     =</span> <span class="dv">0</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">h0.v     =</span> <span class="dv">1</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">sigmav.s =</span> <span class="dv">1</span>,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">sigmav.nu=</span> <span class="dv">1</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(S1<span class="sc">+</span>S2)){</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    V.bar.inv            <span class="ot">&lt;-</span> <span class="fu">t</span>(X)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>H.posterior[,s])<span class="sc">%*%</span>X <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    V.bar                <span class="ot">&lt;-</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    A.bar                <span class="ot">&lt;-</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>H.posterior[,s])<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    nu.bar               <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Y) <span class="sc">+</span> nu.prior</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    S.bar                <span class="ot">&lt;-</span> S.prior <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>H.posterior[,s])<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    S.bar.inv            <span class="ot">&lt;-</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    Sigma.inv.posterior  <span class="ot">&lt;-</span> <span class="fu">rWishart</span>(<span class="dv">1</span>, <span class="at">df =</span> nu.bar, <span class="at">Sigma =</span> S.bar.inv)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior.draw <span class="ot">&lt;-</span> <span class="fu">apply</span>(Sigma.inv.posterior, <span class="dv">3</span>, solve)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior[,,s] <span class="ot">&lt;-</span> Sigma.posterior.draw</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    cholSigma.s          <span class="ot">&lt;-</span> <span class="fu">chol</span>(Sigma.posterior[,,s])</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    A.posterior[,,s]     <span class="ot">&lt;-</span> <span class="fu">matrix</span>(MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="dv">1</span>, <span class="fu">as.vector</span>(A.bar), Sigma.posterior[,,s]<span class="sc">%x%</span>V.bar),<span class="at">ncol=</span>N) </span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    L                    <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>    B0.tilde[,,s]        <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(cholSigma.s))</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    Bplus.tilde[,,s]     <span class="ot">&lt;-</span> B0.tilde[,,s]<span class="sc">%*%</span><span class="fu">t</span>(A.posterior[,,s])</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>        aux <span class="ot">=</span> <span class="fu">list</span>( </span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>              <span class="at">Y               =</span> Y,</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>              <span class="at">X               =</span> X,</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>              <span class="at">H               =</span> <span class="fu">matrix</span>(<span class="dv">1</span>,T,<span class="dv">1</span>),</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>              <span class="at">h0              =</span> <span class="dv">0</span>,</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">sigma.v2        =</span> <span class="dv">1</span>,</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>              <span class="at">s               =</span> <span class="fu">matrix</span>(<span class="dv">1</span>,T,<span class="dv">1</span>),</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>              <span class="at">Sigma           =</span> Sigma.posterior[,,s],</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>              <span class="at">A               =</span> A.posterior[,,s],</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>              <span class="at">sigma2          =</span> <span class="fu">matrix</span>(<span class="dv">1</span>,T,<span class="dv">1</span>)</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>      aux <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>                <span class="at">Y             =</span> Y,</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>                <span class="at">X             =</span> X,</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>                <span class="at">H             =</span> tmp<span class="sc">$</span>H,</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>                <span class="at">h0            =</span> tmp<span class="sc">$</span>h0,</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>                <span class="at">sigma.v2      =</span> tmp<span class="sc">$</span>sigma.v2,</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>                <span class="at">s             =</span> tmp<span class="sc">$</span>s,</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>                <span class="at">Sigma         =</span> Sigma.posterior[,,s],</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>                <span class="at">A             =</span> A.posterior[,,s],</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>                <span class="at">sigma2        =</span> tmp<span class="sc">$</span>sigma2</span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>    tmp                       <span class="ot">&lt;-</span> <span class="fu">SVcommon.Gibbs.iteration</span>(aux,priors)</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>    H.posterior[,s<span class="sc">+</span><span class="dv">1</span>]         <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tmp<span class="sc">$</span>sigma2)</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Sigma.posterior =</span> Sigma.posterior[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(S1<span class="sc">+</span>S2)],</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>              <span class="at">A.posterior     =</span> A.posterior[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(S1<span class="sc">+</span>S2)],</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>              <span class="at">Bplus.tilde     =</span> Bplus.tilde[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(S1<span class="sc">+</span>S2)],</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>              <span class="at">B0.tilde        =</span> B0.tilde[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(S1<span class="sc">+</span>S2)],</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>              <span class="at">H.sv            =</span> H.posterior[,(S1<span class="sc">+</span><span class="dv">2</span>)<span class="sc">:</span>(S1<span class="sc">+</span>S2<span class="sc">+</span><span class="dv">1</span>)]))</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</section>
<section id="the-extension-model-1" class="level4">
<h4 class="anchored" data-anchor-id="the-extension-model-1"><strong>The extension model</strong></h4>
<p>The posterior parameters from the full conditional posterior for the extension model structured as follows.</p>
<span class="math display">\[\begin{align}

\overline{V} &amp;= (X'(diag(\sigma^{2})^{-1}X+ \underline{V}^{-1})^{-1} \\
\overline{A} &amp;= \overline{V}(X'(diag(\sigma^{2})^{-1}Y+\underline{V}^{-1} \underline{A})\\
\overline{\nu} &amp;= T+\underline{\nu}\\
\overline{S} &amp;= \gamma I_{N} + Y'(diag(\sigma^{2})^{-1}Y + \underline{A}'\underline{V}^{-1}\underline{A} -
\overline{A}'\overline{V}^{-1}\overline{A} \\

\end{align}\]</span>
<p>The Gibbs Sampler is used to get the posterior draws of the stochastic volatility model.</p>
<p>For <span class="math inline">\(S_{1} = 1,000\)</span> and <span class="math inline">\(S_{2} = 9,000\)</span></p>
<p>Initialize <span class="math inline">\(\sigma^{2}\)</span> at <span class="math inline">\(\sigma^{2^{(0)}}\)</span> and <span class="math inline">\(\gamma\)</span> at <span class="math inline">\(\gamma^{(0)}\)</span></p>
<p>At each iteration s:</p>
<ol type="1">
<li>Draw <span class="math inline">\(\Sigma^{(s)} \sim P(\Sigma|Y,X,\gamma^{(s-1)},\sigma^{2^{(s-1)}})\)</span></li>
<li>Draw <span class="math inline">\(A^{(s)}\sim P(A|\Sigma^{(s)},Y,X,\sigma^{2^{(s-1)}})\)</span></li>
<li>Draw <span class="math inline">\(\gamma^{(s)} \sim P(\gamma|Y,X,A^{(s)},\Sigma^{(s)},\sigma^{2^{(s-1)}})\)</span></li>
<li>Draw <span class="math inline">\(\sigma^{2^{(s)}} \sim P(\sigma^{2}|Y,X,A^{(s)},\Sigma^{(s)},\gamma^{(s)})\)</span></li>
</ol>
<p>Repeat step 1 to 4 for <span class="math inline">\((S_{1} + S_{2})\)</span> times, then discard the first <span class="math inline">\(S_{1}\)</span> iterations to allow the algorithm to converge to the equilibrium state.</p>
<p>The function for drawing <span class="math inline">\(\sigma^{2^{(s)}} \sim P(\sigma^{2}|Y,X,A^{(s)},\Sigma^{(s)},\gamma^{(s)})\)</span> is the same as in the baseline model since <span class="math inline">\(\gamma\)</span> does not affect the distribution, while the function for drawing steps 1 to 3 is as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Post.draws.stochastic.extension <span class="ot">&lt;-</span> <span class="cf">function</span> (Y,X,prior.parameters.stochastic,S1,S2) {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  N                     <span class="ot">&lt;-</span> <span class="fu">ncol</span>(Y)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  K                     <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  T                     <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Y)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  A.prior               <span class="ot">&lt;-</span> prior.parameters.stochastic<span class="sc">$</span>A.prior</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  V.prior               <span class="ot">&lt;-</span> prior.parameters.stochastic<span class="sc">$</span>V.prior</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  S.prior               <span class="ot">&lt;-</span> prior.parameters.stochastic<span class="sc">$</span>S.prior</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  nu.prior              <span class="ot">&lt;-</span> prior.parameters.stochastic<span class="sc">$</span>nu.prior</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  A.posterior           <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(K,N,(S1<span class="sc">+</span>S2)))</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior       <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,(S1<span class="sc">+</span>S2))) </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  H.posterior           <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(<span class="fu">nrow</span>(Y),(S1<span class="sc">+</span>S2<span class="sc">+</span><span class="dv">1</span>)))  </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  B0.tilde              <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,(S1<span class="sc">+</span>S2)))</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  Bplus.tilde           <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,K,(S1<span class="sc">+</span>S2)))</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  gamma.store           <span class="ot">&lt;-</span> <span class="fu">numeric</span>(S1<span class="sc">+</span>S2)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  H.posterior[,<span class="dv">1</span>]       <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>,T,<span class="dv">1</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  HH                    <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">diag</span>(T)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  mgcv<span class="sc">::</span><span class="fu">sdiag</span>(HH,<span class="sc">-</span><span class="dv">1</span>)    <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  mgcv<span class="sc">::</span><span class="fu">sdiag</span>(HH,<span class="dv">1</span>)     <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  nu.bar         <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Y) <span class="sc">+</span> nu.prior</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  priors <span class="ot">=</span> <span class="fu">list</span>(<span class="at">HH       =</span> HH,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">h0.m     =</span> <span class="dv">0</span>,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">h0.v     =</span> <span class="dv">1</span>,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">sigmav.s =</span> <span class="dv">1</span>,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">sigmav.nu=</span> <span class="dv">1</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(S1<span class="sc">+</span>S2)){</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    V.bar.inv            <span class="ot">&lt;-</span> <span class="fu">t</span>(X)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>H.posterior[,s])<span class="sc">%*%</span>X <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    V.bar                <span class="ot">&lt;-</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    A.bar                <span class="ot">&lt;-</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>H.posterior[,s])<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    S.bar                <span class="ot">&lt;-</span> gamma.store[s] <span class="sc">*</span> <span class="fu">diag</span>(N) <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>H.posterior[,s])<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    Sigma.inv.posterior  <span class="ot">&lt;-</span> <span class="fu">rWishart</span>(<span class="dv">1</span>, <span class="at">df =</span> nu.bar, <span class="at">Sigma =</span> <span class="fu">solve</span>(S.bar))</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior.draw <span class="ot">&lt;-</span> <span class="fu">apply</span>(Sigma.inv.posterior, <span class="dv">3</span>, solve)</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior[,,s] <span class="ot">&lt;-</span> Sigma.posterior.draw</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    cholSigma.s          <span class="ot">&lt;-</span> <span class="fu">chol</span>(Sigma.posterior[,,s])</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    A.posterior[,,s]     <span class="ot">&lt;-</span> <span class="fu">matrix</span>(MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="dv">1</span>, <span class="fu">as.vector</span>(A.bar), Sigma.posterior[,,s]<span class="sc">%x%</span>V.bar),<span class="at">ncol=</span>N) </span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    L                    <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    lambda               <span class="ot">&lt;-</span> ((nu.prior <span class="sc">*</span> N) <span class="sc">-</span> nu.prior) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    chi                  <span class="ot">&lt;-</span> S.prior</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>    psi                  <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(Sigma.posterior[,,<span class="dv">1</span>])))</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    gamma.store[s]       <span class="ot">&lt;-</span> GIGrvg<span class="sc">::</span><span class="fu">rgig</span>(<span class="at">n =</span> <span class="dv">1</span>, lambda, chi, psi)</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>    B0.tilde[,,s]        <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(<span class="fu">chol</span>(Sigma.posterior[,,s])))  </span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>    Bplus.tilde[,,s]     <span class="ot">&lt;-</span> B0.tilde[,,s]<span class="sc">%*%</span><span class="fu">t</span>(A.posterior[,,s])</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>        aux <span class="ot">=</span> <span class="fu">list</span>( </span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>              <span class="at">Y             =</span> Y,</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>              <span class="at">X             =</span> X,</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>              <span class="at">H             =</span> <span class="fu">matrix</span>(<span class="dv">1</span>,T,<span class="dv">1</span>),</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>              <span class="at">h0            =</span> <span class="dv">0</span>,</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>              <span class="at">sigma.v2      =</span> <span class="dv">1</span>,</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>              <span class="at">s             =</span> <span class="fu">matrix</span>(<span class="dv">1</span>,T,<span class="dv">1</span>),</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>              <span class="at">Sigma         =</span> Sigma.posterior[,,s],</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>              <span class="at">A             =</span> A.posterior[,,s],</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>              <span class="at">sigma2        =</span> <span class="fu">matrix</span>(<span class="dv">1</span>,T,<span class="dv">1</span>),</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>              <span class="at">gamma         =</span> <span class="dv">1</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{ </span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>      aux <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>                <span class="at">Y           =</span> Y,</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>                <span class="at">X           =</span> X,</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>                <span class="at">H           =</span> tmp<span class="sc">$</span>H,</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>                <span class="at">h0          =</span> tmp<span class="sc">$</span>h0,</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>                <span class="at">sigma.v2    =</span> tmp<span class="sc">$</span>sigma.v2,</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>                <span class="at">s           =</span> tmp<span class="sc">$</span>s,</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>                <span class="at">Sigma       =</span> Sigma.posterior[,,s],</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>                <span class="at">A           =</span> A.posterior[,,s],</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>                <span class="at">sigma2      =</span> tmp<span class="sc">$</span>sigma2,</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>                <span class="at">gamma       =</span> gamma.store[s]</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>    tmp                     <span class="ot">&lt;-</span> <span class="fu">SVcommon.Gibbs.iteration</span>(aux,priors)</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>    H.posterior[,s<span class="sc">+</span><span class="dv">1</span>]       <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tmp<span class="sc">$</span>sigma2)</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Sigma.posterior =</span> Sigma.posterior[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(S1<span class="sc">+</span>S2)],</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>              <span class="at">A.posterior     =</span> A.posterior[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(S1<span class="sc">+</span>S2)],</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>              <span class="at">Bplus.tilde     =</span> Bplus.tilde[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(S1<span class="sc">+</span>S2)],</span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>              <span class="at">B0.tilde        =</span> B0.tilde[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(S1<span class="sc">+</span>S2)],</span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>              <span class="at">H.sv            =</span> H.posterior[,(S1<span class="sc">+</span><span class="dv">2</span>)<span class="sc">:</span>(S1<span class="sc">+</span>S2<span class="sc">+</span><span class="dv">1</span>)],</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>              <span class="at">gamma.store     =</span> gamma.store[(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(S1<span class="sc">+</span>S2)]))</span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-simulation-2" class="level3">
<h3 class="anchored" data-anchor-id="data-simulation-2">Data simulation</h3>
<section id="the-baseline-model-2" class="level4">
<h4 class="anchored" data-anchor-id="the-baseline-model-2"><strong>The baseline model</strong></h4>
<p>Table 13 demonstrates that the mean values of matrix <span class="math inline">\(A\)</span> remain consistent with those in previous models. However, in Table 14, the variance-covariance matrix has main diagonal values that are nearly zero, deviating significantly from an identity matrix. This contrasts with the model that does not incorporate stochastic volatility.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 13: Mean of the matrix A (The baseline with stochastic volatility model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">RW1</th>
<th style="text-align: right;">RW2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cons</td>
<td style="text-align: right;">0.0641643</td>
<td style="text-align: right;">-0.0642222</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lag1</td>
<td style="text-align: right;">0.9996140</td>
<td style="text-align: right;">0.0003173</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lag2</td>
<td style="text-align: right;">0.0001629</td>
<td style="text-align: right;">0.9995067</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 14: Mean of the variance-covariance matrix (The baseline with stochastic volatility model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">RW1</th>
<th style="text-align: right;">RW2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.0019742</td>
<td style="text-align: right;">-0.0002025</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">-0.0002025</td>
<td style="text-align: right;">0.0018550</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The trace plot in Figure 7 confirms that the value of <span class="math inline">\(A_{21}\)</span> and <span class="math inline">\(A_{32}\)</span> oscillate around 1, while <span class="math inline">\(\Sigma_{11}\)</span> and <span class="math inline">\(\Sigma_{22}\)</span> oscillate around 0.002.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-7-the-trace-plot-of-a-and-sigma-the-baseline-with-stochastic-volatility-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-7-the-trace-plot-of-a-and-sigma-the-baseline-with-stochastic-volatility-model">Figure 7: The trace plot of A and Sigma (The baseline with stochastic volatility model)</h5>
</section>
<p><br></p>
<p>Table 15 indicates that the mean value of the main diagonal of <span class="math inline">\(B_{0}\)</span> increase to around 14-15 which is significantly higher to the previous two models.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 15: Mean of the matrix B0 (The baseline with stochastic volatility model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">14.50806</td>
<td style="text-align: right;">1.95236</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">1.13461</td>
<td style="text-align: right;">14.92466</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In Table 16 which indicate the mean of the matrix <span class="math inline">\(B_{+}\)</span>, the values in the first column, representing the constant term in the equation, are noticeably different from zero compared to the previous models.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 16: Mean of the matrix B+ (The baseline with stochastic volatility model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
<th style="text-align: right;">C3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.7963876</td>
<td style="text-align: right;">14.503023</td>
<td style="text-align: right;">1.95330</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">-0.8912159</td>
<td style="text-align: right;">1.139118</td>
<td style="text-align: right;">14.91747</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The trace plot and histogram in Figure 8 show that the values of <span class="math inline">\(B_{11}\)</span> and <span class="math inline">\(B_{22}\)</span> are widely spread from 0 to around 25, but all of them are positive, consistent with the imposed restriction.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-8-the-trace-plot-and-histogram-of-b0-matrix-the-baseline-with-stochastic-volatility-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-8-the-trace-plot-and-histogram-of-b0-matrix-the-baseline-with-stochastic-volatility-model">Figure 8: The trace plot and histogram of B0 matrix (The baseline with stochastic volatility model)</h5>
</section>
<p><br></p>
<p>The posterior draw mean of <span class="math inline">\(\sigma^{2}\)</span> for each of period display in Figure 9. The <span class="math inline">\(\sigma^{2}\)</span> moves around 2000.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-9-the-posterior-mean-of-the-stochastic-volatility" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-9-the-posterior-mean-of-the-stochastic-volatility">Figure 9: The posterior mean of the stochastic volatility</h5>
</section>
<p><br></p>
<p>Table 17 shows that the mean values of matrix <span class="math inline">\(A\)</span> for lag 1 and lag 2 are equal 1, and the constant value is close to zero. Moreover, in Table 18, the variance-covariance matrix is very closely to zero.</p>
</section>
<section id="the-extension-model-2" class="level4">
<h4 class="anchored" data-anchor-id="the-extension-model-2"><strong>The extension model</strong></h4>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 17: Mean of the matrix A (The extension with stochastic volatility model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">RW1</th>
<th style="text-align: right;">RW2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cons</td>
<td style="text-align: right;">1.09e-05</td>
<td style="text-align: right;">-9.4e-06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lag1</td>
<td style="text-align: right;">1.00e+00</td>
<td style="text-align: right;">0.0e+00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lag2</td>
<td style="text-align: right;">0.00e+00</td>
<td style="text-align: right;">1.0e+00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 18: Mean of the variance-covariance matrix (The extension with stochastic volatility model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">RW1</th>
<th style="text-align: right;">RW2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">1e-10</td>
<td style="text-align: right;">-1e-10</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">-1e-10</td>
<td style="text-align: right;">1e-10</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The trace plot and histogram depicted in Figure 10 indicate that the values of <span class="math inline">\(A_{21}\)</span> and <span class="math inline">\(A_{32}\)</span> fluctuate around 1, whereas <span class="math inline">\(\Sigma_{11}\)</span> and <span class="math inline">\(\Sigma_{22}\)</span> are nearly zero.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-10-the-trace-plot-of-a-and-sigma-the-extension-with-stochastic-volatility-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-10-the-trace-plot-of-a-and-sigma-the-extension-with-stochastic-volatility-model">Figure 10: The trace plot of A and Sigma (The extension with stochastic volatility model)</h5>
</section>
<p><br></p>
<p>Table 19 indicates that the mean value of the matrix <span class="math inline">\(B_{0}\)</span> is notably elevated, which diverges markedly from all previous models. And the mean value of the matrix <span class="math inline">\(B_{+}\)</span> display in Table 20.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 19: Mean of the matrix B0 (The extension with stochastic volatility model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">512367.8</td>
<td style="text-align: right;">336463.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">337738.0</td>
<td style="text-align: right;">527123.4</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 20: Mean of the matrix B+ (The extension with stochastic volatility model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
<th style="text-align: right;">C3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.0162006</td>
<td style="text-align: right;">512367.8</td>
<td style="text-align: right;">336463.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">-0.0673843</td>
<td style="text-align: right;">337738.0</td>
<td style="text-align: right;">527123.4</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The trace plot and histogram in Figure 11 reveal that the values of <span class="math inline">\(B_{11}\)</span> and <span class="math inline">\(B_{22}\)</span> span widely from zero to approximately million, confirming the high mean value reported in Table 19.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-11-the-trace-plot-and-histogram-of-b0-matrix-the-extension-with-stochastic-volatility-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-11-the-trace-plot-and-histogram-of-b0-matrix-the-extension-with-stochastic-volatility-model">Figure 11: The trace plot and histogram of B0 matrix (The extension with stochastic volatility model)</h5>
</section>
<p><br></p>
<p>The mean value of <span class="math inline">\(\gamma\)</span> is equal 1.8238, which is close to that of the extension model without incorporating stochastic volatility heteroskedasticity. The plot and histogram shown in Figure 12.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-12-the-plot-and-histogram-of-gamma-the-extension-with-stochastic-volatility-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-12-the-plot-and-histogram-of-gamma-the-extension-with-stochastic-volatility-model">Figure 12: The plot and histogram of gamma (The extension with stochastic volatility model)</h5>
</section>
<p><br></p>
<p>The posterior draw mean of <span class="math inline">\(\sigma^{2}\)</span> for each of period is displayed in Figure 13. For certain periods, <span class="math inline">\(\sigma^{2}\)</span> exhibits a significant increase to a very large value.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-13-the-posterior-mean-of-the-stochastic-volatility-the-extension-with-stochastic-volatility-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-13-the-posterior-mean-of-the-stochastic-volatility-the-extension-with-stochastic-volatility-model">Figure 13: The posterior mean of the stochastic volatility (The extension with stochastic volatility model)</h5>
</section>
<p><br></p>
<p>Once we prove that the algorithm and coding can work with the simulated random walk data, the author will apply the same procedure to the empirical data, which contains 6 variables as indicated in the methodology section.</p>
</section>
</section>
</section>
</section>
<section id="empirical-estimation" class="level1">
<h1>Empirical estimation</h1>
<p>The sign restriction that the author want to impose is applied to the contemporaneous shock or matrix <span class="math inline">\(B_{0}^{-1}\)</span> which is attached to the <span class="math inline">\(u_{t}\)</span> after transforming the SVAR model equation.</p>
<span class="math display">\[\begin{align}
B_0y_t &amp;= b_0 + \sum_{i=1}^{p}B_{i}y_{t-i}+u_t  \\

y_t &amp;= B_0^{-1}b_0 + \sum_{i=1}^{p}B_0^{-1}B_{i}y_{t-i} + B_0^{-1}u_t

\end{align}\]</span>
<p>However, the SVAR model can be estimated after estimating the reduced form. To obtain the matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(\Sigma\)</span> from the reduced form, the author uses the same technique as when dealing with the simulation data, which involves randomly drawing both matrices from the posterior distribution.</p>
<p>One of the changes is the prior value of <span class="math inline">\(\kappa_{1}\)</span>, which represents the overall shrinkage level of the autoregressive slope. Formerly, for the simulation data, the author used <span class="math inline">\(0.02^{2}\)</span>, indicating very strong shrinkage. In this section, the author will loosen the shrinkage to 1 (no shrinkage).</p>
<p><br></p>
<p>The sign restriction for the monetary policy shock using Taylor’s rule is as follows.</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>cashrate</th>
<th>realgdp</th>
<th>CPI</th>
<th>unemprate</th>
<th>stockprice</th>
<th>govexp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>monetary policy shock</td>
<td>+</td>
<td>-</td>
<td>-</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>A monetary policy shock that raises the cash rate target will cool down inflationary pressures (leading to a decrease in <em>CPI</em>) and also slow down economic growth (resulting in a decrease in <em>realgdp</em>).</p>
<p><br></p>
<p>As mentioned earlier, this study includes <em>govexp</em> as a control variable for fiscal policy in the model. The sign restriction is imposed on <em>govexp</em> itself, indicating an increase in government expenditure.</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>cashrate</th>
<th>realgdp</th>
<th>CPI</th>
<th>unemprate</th>
<th>stockprice</th>
<th>govexp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>fiscal policy shock</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>+</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Or can be represented in the compact form as follows.</p>
<span class="math display">\[\begin{bmatrix}
\text{cashrate} \\
\text{realgdp} \\
\text{CPI} \\
\text{unemprate} \\
\text{stockprice} \\
\text{govexp}
\end{bmatrix}
=
\underbrace{\begin{bmatrix}
    + &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? \\
    - &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? \\
    - &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? \\
    \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? \\
    \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? \\
    \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; \color{Grey}? &amp;&amp; + \\
\end{bmatrix}}_{B_{0}^{-1}}
*
\begin{bmatrix}
{u_{t}^{monetary\:pol.}} \\
{\color{Grey}u_{\color{Grey}t}}^{\color{Grey}2} \\
{\color{Grey}u_{\color{Grey}t}}^{\color{Grey}3} \\
{\color{Grey}u_{\color{Grey}t}}^{\color{Grey}4} \\
{\color{Grey}u_{\color{Grey}t}}^{\color{Grey}5} \\
{u_{t}^{fiscal\:pol.}}
\end{bmatrix} \]</span>
<p>Since the restriction on the simulated data has been changed, the new function can be represented as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ImposeSignRestriction.empirical <span class="ot">&lt;-</span> <span class="cf">function</span> (N,p,posterior.draws, S){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  A.posterior    <span class="ot">&lt;-</span> posterior.draws<span class="sc">$</span>A.posterior</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior<span class="ot">&lt;-</span> posterior.draws<span class="sc">$</span>Sigma.posterior</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  B0.tilde       <span class="ot">&lt;-</span> posterior.draws<span class="sc">$</span>B0.tilde</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  Bplus.tilde    <span class="ot">&lt;-</span> posterior.draws<span class="sc">$</span>Bplus.tilde</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  S              <span class="ot">&lt;-</span> <span class="fu">dim</span>(A.posterior)[<span class="dv">3</span>]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  B0.store       <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  Bplus.store    <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,K,S))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  B0.inv.store   <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  i.vec <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    B0.tilde1    <span class="ot">&lt;-</span> B0.tilde[,,s]</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    Bplus.tilde1 <span class="ot">&lt;-</span> Bplus.tilde[,,s]</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    sign.restrictions.do.not.hold <span class="ot">=</span> <span class="cn">TRUE</span> </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (sign.restrictions.do.not.hold){</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    X            <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(N<span class="sc">*</span>N),N,N)         </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    QR           <span class="ot">&lt;-</span> <span class="fu">qr</span>(X, <span class="at">tol =</span> <span class="fl">1e-10</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    Q            <span class="ot">&lt;-</span> <span class="fu">qr.Q</span>(QR,<span class="at">complete=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    R            <span class="ot">&lt;-</span> <span class="fu">qr.R</span>(QR,<span class="at">complete=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    Q            <span class="ot">&lt;-</span> <span class="fu">t</span>(Q <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="fu">sign</span>(<span class="fu">diag</span>(R))))</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    B0           <span class="ot">&lt;-</span> Q<span class="sc">%*%</span>B0.tilde1                   </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    Bplus        <span class="ot">&lt;-</span> Q<span class="sc">%*%</span>Bplus.tilde1                  </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    B0.inv       <span class="ot">&lt;-</span> <span class="fu">solve</span>(B0)      </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    check        <span class="ot">&lt;-</span> (B0.inv[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> B0.inv[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> B0.inv[<span class="dv">3</span>, <span class="dv">1</span>] <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> B0.inv[<span class="dv">6</span>, <span class="dv">6</span>] <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">&gt;</span><span class="dv">0</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (check){sign.restrictions.do.not.hold<span class="ot">=</span><span class="cn">FALSE</span>}</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span> </span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    i.vec             <span class="ot">&lt;-</span> <span class="fu">c</span>(i.vec,i) </span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    B0.store[,,s]     <span class="ot">&lt;-</span> B0</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    Bplus.store[,,s]  <span class="ot">&lt;-</span> Bplus</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    B0.inv.store[,,s] <span class="ot">&lt;-</span> B0.inv</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">list</span>(<span class="at">B0.store     =</span> B0.store[,,<span class="dv">1</span><span class="sc">:</span>S],</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>               <span class="at">Bplus.store  =</span> Bplus.store[,,<span class="dv">1</span><span class="sc">:</span>S],</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>               <span class="at">B0.inv.store =</span> B0.inv.store[,,<span class="dv">1</span><span class="sc">:</span>S],</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>               <span class="at">i            =</span> i.vec))</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="the-baseline-model-3" class="level2">
<h2 class="anchored" data-anchor-id="the-baseline-model-3">The baseline model</h2>
<p>After imposing these restrictions on <span class="math inline">\(B_{0}^{-1}\)</span>, the mean of <span class="math inline">\(B_{0}^{-1}\)</span> is displayed in Table 9, conforming to the sign restrictions in the <span class="math inline">\(1^{st} - 3^{rd}\)</span> rows of the <span class="math inline">\(1^{st}\)</span> column and the <span class="math inline">\(6^{th}\)</span> row of the <span class="math inline">\(6^{th}\)</span> column, denoted as <span class="math inline">\(B_{11},B_{21}, B_{31}\)</span>, and <span class="math inline">\(B_{66}\)</span> respectively.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 21: Mean of the B0 inverse matrix</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
<th style="text-align: right;">C3</th>
<th style="text-align: right;">C4</th>
<th style="text-align: right;">C5</th>
<th style="text-align: right;">C6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.1143</td>
<td style="text-align: right;">-0.0013</td>
<td style="text-align: right;">8e-04</td>
<td style="text-align: right;">-0.0016</td>
<td style="text-align: right;">0.0023</td>
<td style="text-align: right;">-0.0100</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">-0.0034</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0.0001</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R3</td>
<td style="text-align: right;">-0.0018</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">R4</td>
<td style="text-align: right;">0.0703</td>
<td style="text-align: right;">0.0017</td>
<td style="text-align: right;">-1e-04</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0015</td>
<td style="text-align: right;">-0.0039</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R5</td>
<td style="text-align: right;">0.0058</td>
<td style="text-align: right;">0.0004</td>
<td style="text-align: right;">2e-04</td>
<td style="text-align: right;">-0.0002</td>
<td style="text-align: right;">-0.0002</td>
<td style="text-align: right;">-0.0043</td>
</tr>
<tr class="even">
<td style="text-align: left;">R6</td>
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0048</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 22: SD of the B0 inverse matrix</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
<th style="text-align: right;">C3</th>
<th style="text-align: right;">C4</th>
<th style="text-align: right;">C5</th>
<th style="text-align: right;">C6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.0796</td>
<td style="text-align: right;">0.1583</td>
<td style="text-align: right;">0.1590</td>
<td style="text-align: right;">0.1592</td>
<td style="text-align: right;">0.1590</td>
<td style="text-align: right;">0.1596</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">0.0022</td>
<td style="text-align: right;">0.0039</td>
<td style="text-align: right;">0.0039</td>
<td style="text-align: right;">0.0038</td>
<td style="text-align: right;">0.0039</td>
<td style="text-align: right;">0.0038</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R3</td>
<td style="text-align: right;">0.0012</td>
<td style="text-align: right;">0.0022</td>
<td style="text-align: right;">0.0022</td>
<td style="text-align: right;">0.0022</td>
<td style="text-align: right;">0.0022</td>
<td style="text-align: right;">0.0022</td>
</tr>
<tr class="even">
<td style="text-align: left;">R4</td>
<td style="text-align: right;">0.0957</td>
<td style="text-align: right;">0.1111</td>
<td style="text-align: right;">0.1109</td>
<td style="text-align: right;">0.1105</td>
<td style="text-align: right;">0.1099</td>
<td style="text-align: right;">0.1108</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R5</td>
<td style="text-align: right;">0.0274</td>
<td style="text-align: right;">0.0274</td>
<td style="text-align: right;">0.0276</td>
<td style="text-align: right;">0.0279</td>
<td style="text-align: right;">0.0277</td>
<td style="text-align: right;">0.0272</td>
</tr>
<tr class="even">
<td style="text-align: left;">R6</td>
<td style="text-align: right;">0.0059</td>
<td style="text-align: right;">0.0060</td>
<td style="text-align: right;">0.0058</td>
<td style="text-align: right;">0.0059</td>
<td style="text-align: right;">0.0059</td>
<td style="text-align: right;">0.0033</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The trace plot and histogram of the restricted variable confirms that <span class="math inline">\(B_{0}^{-1}\)</span> shows <span class="math inline">\(B_{11}\)</span> as positive, <span class="math inline">\(B_{21}\)</span> and <span class="math inline">\(B_{31}\)</span> as negative, and <span class="math inline">\(B_{66}\)</span> as positive, consistent with the specified restrictions.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-14-the-trace-plot-and-histogram-of-b0-inverse-the-baseline-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-14-the-trace-plot-and-histogram-of-b0-inverse-the-baseline-model">Figure 14: The trace plot and histogram of B0 inverse (The baseline model)</h5>
</section>
<section id="impulse-response-function" class="level3">
<h3 class="anchored" data-anchor-id="impulse-response-function">Impulse response function</h3>
<p>The function for calculating impulse response is as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>compute_IRF <span class="ot">&lt;-</span> <span class="cf">function</span>(h, S2, N, p) {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  A.posterior       <span class="ot">&lt;-</span> posterior.draws<span class="sc">$</span>A.posterior</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  B0_inv_store      <span class="ot">&lt;-</span> B.draws.restricted<span class="sc">$</span>B0.inv.store</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  IRF.posterior     <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(N, N, h <span class="sc">+</span> <span class="dv">1</span>, S2))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  IRF.inf.posterior <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(N, N, S2))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  J                 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">diag</span>(N), <span class="fu">matrix</span>(<span class="dv">0</span>, N, N <span class="sc">*</span> (p <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S2) {</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    A.bold                      <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">t</span>(A.posterior[<span class="dv">2</span><span class="sc">:</span>(<span class="dv">1</span> <span class="sc">+</span> N <span class="sc">*</span> p), , s]), </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">cbind</span>(<span class="fu">diag</span>(N <span class="sc">*</span> (p <span class="sc">-</span> <span class="dv">1</span>)), <span class="fu">matrix</span>(<span class="dv">0</span>, N <span class="sc">*</span> (p <span class="sc">-</span> <span class="dv">1</span>), N)))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    IRF.inf.posterior[, , s]    <span class="ot">&lt;-</span> J <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">diag</span>(N <span class="sc">*</span> p) <span class="sc">-</span> A.bold) <span class="sc">%*%</span> <span class="fu">t</span>(J) <span class="sc">%*%</span> B0_inv_store[, , s]</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    A.bold.power                <span class="ot">&lt;-</span> A.bold</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(h <span class="sc">+</span> <span class="dv">1</span>)) {</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        IRF.posterior[, , i, s] <span class="ot">&lt;-</span> B0_inv_store[, , s]</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        IRF.posterior[, , i, s] <span class="ot">&lt;-</span> J <span class="sc">%*%</span> A.bold.power <span class="sc">%*%</span> <span class="fu">t</span>(J) <span class="sc">%*%</span> B0_inv_store[, , s]</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        A.bold.power            <span class="ot">&lt;-</span> A.bold.power <span class="sc">%*%</span> A.bold</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">IRF.posterior     =</span> IRF.posterior, </span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">IRF.inf.posterior =</span> IRF.inf.posterior))</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-15-the-impulse-response-to-the-monetary-shock-baseline-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-15-the-impulse-response-to-the-monetary-shock-baseline-model">Figure 15: The impulse response to the monetary shock (baseline model)</h5>
</section>
<p><br></p>
<p>The <a href="#figure-15-the-impulse-response-to-the-monetary-shock-baseline-model">Figure 15: The impulse response to the monetary shock (baseline model)</a> displays the response to the monetary shock. The light yellow shaded area represents the 68% confidence interval. In the short run to medium run, half year to three years after the shock, real GDP experiences a slight decline. Similarly, in the medium run, three to four years after the shock, the CPI also shows a slight decrease, and both variables exhibiting a persistent trend.</p>
<p>Regarding the cash rate itself, after rising from the shock, it tends to normalize after 2.5 years. The unemployment rate rises contemporaneously with the shock and persists even 5 years afterward. However, the stock price and government expenditure do not show any pronounced response. Unfortunately, for these four variables, including zero in the shaded area indicates that they are not significantly different from zero.</p>
</section>
</section>
<section id="the-extension-model-3" class="level2">
<h2 class="anchored" data-anchor-id="the-extension-model-3">The extension model</h2>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 23: Mean of the B0 inverse matrix (extension model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
<th style="text-align: right;">C3</th>
<th style="text-align: right;">C4</th>
<th style="text-align: right;">C5</th>
<th style="text-align: right;">C6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.1131</td>
<td style="text-align: right;">-0.0021</td>
<td style="text-align: right;">0.0028</td>
<td style="text-align: right;">0.0013</td>
<td style="text-align: right;">0.0017</td>
<td style="text-align: right;">-0.0088</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">-0.0034</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0001</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R3</td>
<td style="text-align: right;">-0.0017</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">R4</td>
<td style="text-align: right;">0.0683</td>
<td style="text-align: right;">0.0016</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0004</td>
<td style="text-align: right;">0.0006</td>
<td style="text-align: right;">-0.0075</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R5</td>
<td style="text-align: right;">0.0053</td>
<td style="text-align: right;">-0.0005</td>
<td style="text-align: right;">-0.0002</td>
<td style="text-align: right;">0.0006</td>
<td style="text-align: right;">0.0006</td>
<td style="text-align: right;">-0.0040</td>
</tr>
<tr class="even">
<td style="text-align: left;">R6</td>
<td style="text-align: right;">0.0006</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0049</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 24: SD of the B0 inverse matrix (extension model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
<th style="text-align: right;">C3</th>
<th style="text-align: right;">C4</th>
<th style="text-align: right;">C5</th>
<th style="text-align: right;">C6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.0791</td>
<td style="text-align: right;">0.1598</td>
<td style="text-align: right;">0.1594</td>
<td style="text-align: right;">0.1609</td>
<td style="text-align: right;">0.1567</td>
<td style="text-align: right;">0.1565</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">0.0022</td>
<td style="text-align: right;">0.0039</td>
<td style="text-align: right;">0.0038</td>
<td style="text-align: right;">0.0039</td>
<td style="text-align: right;">0.0039</td>
<td style="text-align: right;">0.0038</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R3</td>
<td style="text-align: right;">0.0012</td>
<td style="text-align: right;">0.0022</td>
<td style="text-align: right;">0.0022</td>
<td style="text-align: right;">0.0022</td>
<td style="text-align: right;">0.0022</td>
<td style="text-align: right;">0.0022</td>
</tr>
<tr class="even">
<td style="text-align: left;">R4</td>
<td style="text-align: right;">0.0972</td>
<td style="text-align: right;">0.1110</td>
<td style="text-align: right;">0.1104</td>
<td style="text-align: right;">0.1099</td>
<td style="text-align: right;">0.1104</td>
<td style="text-align: right;">0.1096</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R5</td>
<td style="text-align: right;">0.0271</td>
<td style="text-align: right;">0.0276</td>
<td style="text-align: right;">0.0272</td>
<td style="text-align: right;">0.0278</td>
<td style="text-align: right;">0.0278</td>
<td style="text-align: right;">0.0272</td>
</tr>
<tr class="even">
<td style="text-align: left;">R6</td>
<td style="text-align: right;">0.0059</td>
<td style="text-align: right;">0.0059</td>
<td style="text-align: right;">0.0058</td>
<td style="text-align: right;">0.0058</td>
<td style="text-align: right;">0.0059</td>
<td style="text-align: right;">0.0033</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The mean value of <span class="math inline">\(\gamma\)</span> is equal 0.0015, which is close to zero. The plot and histogram shown in Figure 16 confirms that the draw oscillates around 0.0015.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-16-the-plot-and-histogram-of-gamma-the-extension-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-16-the-plot-and-histogram-of-gamma-the-extension-model">Figure 16: The plot and histogram of gamma (The extension model)</h5>
</section>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-17-the-trace-plot-and-histogram-of-b0-inverse-the-extension-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-17-the-trace-plot-and-histogram-of-b0-inverse-the-extension-model">Figure 17: The trace plot and histogram of B0 inverse (The extension model)</h5>
</section>
<section id="impulse-response-function-1" class="level3">
<h3 class="anchored" data-anchor-id="impulse-response-function-1">Impulse response function</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-18-the-impulse-response-to-the-monetary-shock-extension-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-18-the-impulse-response-to-the-monetary-shock-extension-model">Figure 18: The impulse response to the monetary shock (extension model)</h5>
</section>
<p><br></p>
<p>However, the <a href="#figure-18-the-impulse-response-to-the-monetary-shock-extension-model">Figure 18: The impulse response to the monetary shock (extension model)</a> displays the impulse response slightly differently from what it represents in Figure 15, the baseline model. The CPI tends to decrease after 2.5 year of the shock and continues declining even after 5 years without a chance to recover. Furthermore, real GDP is observed to decrease from half a year up to around 5 years after the shock. Moreover, the unemployment rate significantly increase a little bit during after 3 - 5 years after the shock.</p>
<p>As for the cash rate, stock price, and government expenditure, there isn’t much different from the previous model. All of these variables remain not significantly different from zero.</p>
</section>
</section>
<section id="the-baseline-with-stochastic-volatillity-model" class="level2">
<h2 class="anchored" data-anchor-id="the-baseline-with-stochastic-volatillity-model">The baseline with Stochastic volatillity model</h2>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 25: Mean of the B0 inverse matrix</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
<th style="text-align: right;">C3</th>
<th style="text-align: right;">C4</th>
<th style="text-align: right;">C5</th>
<th style="text-align: right;">C6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.0220</td>
<td style="text-align: right;">7e-04</td>
<td style="text-align: right;">2e-04</td>
<td style="text-align: right;">-2e-04</td>
<td style="text-align: right;">-3e-04</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">-0.0004</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">-0.0001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R3</td>
<td style="text-align: right;">-0.0003</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">R4</td>
<td style="text-align: right;">0.0010</td>
<td style="text-align: right;">-6e-04</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">-1e-04</td>
<td style="text-align: right;">-4e-04</td>
<td style="text-align: right;">-0.0010</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R5</td>
<td style="text-align: right;">0.0004</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">-0.0011</td>
</tr>
<tr class="even">
<td style="text-align: left;">R6</td>
<td style="text-align: right;">0.0004</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0.0011</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 26: SD of the B0 inverse matrix</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
<th style="text-align: right;">C3</th>
<th style="text-align: right;">C4</th>
<th style="text-align: right;">C5</th>
<th style="text-align: right;">C6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.0170</td>
<td style="text-align: right;">0.0300</td>
<td style="text-align: right;">0.0300</td>
<td style="text-align: right;">0.0303</td>
<td style="text-align: right;">0.0302</td>
<td style="text-align: right;">0.0305</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">0.0003</td>
<td style="text-align: right;">0.0007</td>
<td style="text-align: right;">0.0007</td>
<td style="text-align: right;">0.0007</td>
<td style="text-align: right;">0.0007</td>
<td style="text-align: right;">0.0007</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R3</td>
<td style="text-align: right;">0.0002</td>
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">0.0005</td>
</tr>
<tr class="even">
<td style="text-align: left;">R4</td>
<td style="text-align: right;">0.0233</td>
<td style="text-align: right;">0.0243</td>
<td style="text-align: right;">0.0246</td>
<td style="text-align: right;">0.0246</td>
<td style="text-align: right;">0.0247</td>
<td style="text-align: right;">0.0247</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R5</td>
<td style="text-align: right;">0.0075</td>
<td style="text-align: right;">0.0078</td>
<td style="text-align: right;">0.0078</td>
<td style="text-align: right;">0.0079</td>
<td style="text-align: right;">0.0078</td>
<td style="text-align: right;">0.0077</td>
</tr>
<tr class="even">
<td style="text-align: left;">R6</td>
<td style="text-align: right;">0.0014</td>
<td style="text-align: right;">0.0015</td>
<td style="text-align: right;">0.0014</td>
<td style="text-align: right;">0.0014</td>
<td style="text-align: right;">0.0014</td>
<td style="text-align: right;">0.0009</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-19-the-trace-plot-and-histogram-of-b0-inverse-the-basic-with-stochastic-volatility-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-19-the-trace-plot-and-histogram-of-b0-inverse-the-basic-with-stochastic-volatility-model">Figure 19: The trace plot and histogram of B0 inverse (The basic with stochastic volatility model)</h5>
</section>
<p>The posterior draw mean of <span class="math inline">\(\sigma^{2}\)</span> for each period is displayed in Figure 20. The <span class="math inline">\(\sigma^{2}\)</span> moves around 8000. We can also see that the <span class="math inline">\(\sigma^{2}\)</span> rises up to 60000 in some particular periods.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-20-the-posterior-mean-of-the-stochastic-volatility-the-baseline-with-stochastic-volatility-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-20-the-posterior-mean-of-the-stochastic-volatility-the-baseline-with-stochastic-volatility-model">Figure 20: The posterior mean of the stochastic volatility (The baseline with stochastic volatility model)</h5>
</section>
<section id="impulse-response-function-2" class="level3">
<h3 class="anchored" data-anchor-id="impulse-response-function-2">Impulse response function</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-21-the-impulse-response-to-the-monetary-shock-the-baseline-with-stochastic-volatility-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-21-the-impulse-response-to-the-monetary-shock-the-baseline-with-stochastic-volatility-model">Figure 21: The impulse response to the monetary shock (the baseline with stochastic volatility model)</h5>
</section>
<p>The <a href="#figure-21-the-impulse-response-to-the-monetary-shock-the-baseline-with-stochastic-volatility-model">Figure 21: The impulse response to the monetary shock (the baseline with stochastic volatility model)</a> displays the impulse response differently from how it is represented in the previous two models. We cannot observe the cash rate normalizing around three years after the shock. Moreover, the CPI decreases at the same time as the monetary shock. However, it exhibits an increasing trend, tending to recover five years after the shock. Additionally, we cannot observe the unemployment rate increase that was seen at the same time in the previous two models. All of these variables remain not significantly different from zero.</p>
</section>
</section>
<section id="the-extension-with-stochastic-volatillity-model" class="level2">
<h2 class="anchored" data-anchor-id="the-extension-with-stochastic-volatillity-model">The extension with Stochastic volatillity model</h2>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 27: Mean of the B0 inverse matrix</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
<th style="text-align: right;">C3</th>
<th style="text-align: right;">C4</th>
<th style="text-align: right;">C5</th>
<th style="text-align: right;">C6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">2.8e-06</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">1e-07</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">-7.0e-07</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">-1.0e-07</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">1.0e-07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R3</td>
<td style="text-align: right;">-1.0e-07</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0.0e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">R4</td>
<td style="text-align: right;">1.5e-06</td>
<td style="text-align: right;">1e-07</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1e-07</td>
<td style="text-align: right;">-1.5e-06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R5</td>
<td style="text-align: right;">-2.0e-07</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">-1.0e-07</td>
</tr>
<tr class="even">
<td style="text-align: left;">R6</td>
<td style="text-align: right;">-2.0e-07</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">2.0e-07</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 28: SD of the B0 inverse matrix</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
<th style="text-align: right;">C3</th>
<th style="text-align: right;">C4</th>
<th style="text-align: right;">C5</th>
<th style="text-align: right;">C6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">4.4e-06</td>
<td style="text-align: right;">8.2e-06</td>
<td style="text-align: right;">5.7e-06</td>
<td style="text-align: right;">7.0e-06</td>
<td style="text-align: right;">9.1e-06</td>
<td style="text-align: right;">7.7e-06</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">3.0e-07</td>
<td style="text-align: right;">3.0e-07</td>
<td style="text-align: right;">3.0e-07</td>
<td style="text-align: right;">2.0e-07</td>
<td style="text-align: right;">3.0e-07</td>
<td style="text-align: right;">3.0e-07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R3</td>
<td style="text-align: right;">1.0e-07</td>
<td style="text-align: right;">1.0e-07</td>
<td style="text-align: right;">2.0e-07</td>
<td style="text-align: right;">1.0e-07</td>
<td style="text-align: right;">1.0e-07</td>
<td style="text-align: right;">1.0e-07</td>
</tr>
<tr class="even">
<td style="text-align: left;">R4</td>
<td style="text-align: right;">7.2e-06</td>
<td style="text-align: right;">7.1e-06</td>
<td style="text-align: right;">7.8e-06</td>
<td style="text-align: right;">7.0e-06</td>
<td style="text-align: right;">7.2e-06</td>
<td style="text-align: right;">6.9e-06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R5</td>
<td style="text-align: right;">1.5e-06</td>
<td style="text-align: right;">1.6e-06</td>
<td style="text-align: right;">1.6e-06</td>
<td style="text-align: right;">1.4e-06</td>
<td style="text-align: right;">1.6e-06</td>
<td style="text-align: right;">1.5e-06</td>
</tr>
<tr class="even">
<td style="text-align: left;">R6</td>
<td style="text-align: right;">5.0e-07</td>
<td style="text-align: right;">5.0e-07</td>
<td style="text-align: right;">5.0e-07</td>
<td style="text-align: right;">5.0e-07</td>
<td style="text-align: right;">5.0e-07</td>
<td style="text-align: right;">4.0e-07</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-22-the-trace-plot-and-histogram-of-b0-inverse-the-basic-with-stochastic-volatility-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-22-the-trace-plot-and-histogram-of-b0-inverse-the-basic-with-stochastic-volatility-model">Figure 22: The trace plot and histogram of B0 inverse (The basic with stochastic volatility model)</h5>
</section>
<p><br></p>
<p>The mean value of <span class="math inline">\(\gamma\)</span> is equal 0.0016, which is close to zero and also almost the same as before the author incorporates the stochastic volatility. The plot and histogram shown in Figure 22.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-23-the-plot-and-histogram-of-gamma-the-extension-with-stochastic-volatility-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-23-the-plot-and-histogram-of-gamma-the-extension-with-stochastic-volatility-model">Figure 23: The plot and histogram of gamma (The extension with stochastic volatility model)</h5>
</section>
<p><br></p>
<p>The posterior draw mean of <span class="math inline">\(\sigma^{2}\)</span> for each period is displayed in Figure 24. The <span class="math inline">\(\sigma^{2}\)</span> is significantly higher compared to the previous model.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-24-the-posterior-mean-of-the-stochastic-volatility-the-extension-with-stochastic-volatility-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-24-the-posterior-mean-of-the-stochastic-volatility-the-extension-with-stochastic-volatility-model">Figure 24: The posterior mean of the stochastic volatility (The extension with stochastic volatility model)</h5>
</section>
<section id="impulse-response-function-3" class="level3">
<h3 class="anchored" data-anchor-id="impulse-response-function-3">Impulse response function</h3>
<p>However, the <a href="#figure-25-the-impulse-response-to-the-monetary-shock-the-extension-with-stochastic-volatility-model">Figure 25: The impulse response to the monetary shock (the extension with stochastic volatility model)</a>, displays the point estimate impulse response as a flat line, indicating a value actually close to zero. The 68% confidence interval is also flat. We cannot observe any significant effect on all six variables in the system. One possible explanation is that we might need more observations to capture the heteroskedasticity, which, in this case, is not sufficient.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-25-the-impulse-response-to-the-monetary-shock-the-extension-with-stochastic-volatility-model" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-25-the-impulse-response-to-the-monetary-shock-the-extension-with-stochastic-volatility-model">Figure 25: The impulse response to the monetary shock (the extension with stochastic volatility model)</h5>
</section>
</section>
</section>
<section id="references" class="level2 unnumbered">




</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Bjornland2009" class="csl-entry" role="listitem">
Bjørnland, HC, and K Leitemo. 2009. <span>“Identifying the Interdependence Between US Monetary Policy and the Stock Market.”</span> <em>Journal of Monetary Economics</em> 56(2): 275–82. <a href="https://doi.org/10.1016/j.jmoneco.2008.12.001">https://doi.org/10.1016/j.jmoneco.2008.12.001</a>.
</div>
<div id="ref-BrischettoVoss1999" class="csl-entry" role="listitem">
Brischetto, Andrea, and Graham Voss. 1999. <span>“A Structural Vector Autoregression Model of Monetary Policy in Australia.”</span> <em>Reserve Bank of Australia</em>.
</div>
<div id="ref-Ioannidis2008" class="csl-entry" role="listitem">
Ioannidis, Christos, and Alexandros Kontonikas. 2008. <span>“The Impact of Monetary Policy on Stock Prices. Journal of Policy Modeling.”</span> <em>Journal of Policy Modeling</em> 30(1): 33–53. <a href="https://doi.org/10.1016/j.jpolmod.2007.06.015">https://doi.org/10.1016/j.jpolmod.2007.06.015</a>.
</div>
<div id="ref-Mojon2001" class="csl-entry" role="listitem">
Mojon, Benoit, and Gert Peersman. 2001. <span>“A VAR Description of the Effects of Monetary Policy in the Individual Countries of the Euro Area.”</span> <a href="http://dx.doi.org/10.2139/ssrn.303801">http://dx.doi.org/10.2139/ssrn.303801</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>