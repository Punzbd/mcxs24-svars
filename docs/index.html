<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pun Suparattanapinan">

<title>Macroeconometrics Research Report - The Impact of Monetary Policy on the Real Economy and the Stock Market: The Case of Australia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Macroeconometrics Research Report</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#preliminary-results" id="toc-preliminary-results" class="nav-link" data-scroll-target="#preliminary-results">Preliminary Results</a>
  <ul class="collapse">
  <li><a href="#the-autocorrelation-and-partial-autocorrelation" id="toc-the-autocorrelation-and-partial-autocorrelation" class="nav-link" data-scroll-target="#the-autocorrelation-and-partial-autocorrelation">The autocorrelation and partial autocorrelation</a></li>
  <li><a href="#the-unit-root-test" id="toc-the-unit-root-test" class="nav-link" data-scroll-target="#the-unit-root-test">The unit root test</a></li>
  </ul></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">Methodology</a></li>
  <li><a href="#estimation" id="toc-estimation" class="nav-link" data-scroll-target="#estimation">Estimation</a>
  <ul class="collapse">
  <li><a href="#the-baseline-model" id="toc-the-baseline-model" class="nav-link" data-scroll-target="#the-baseline-model">The baseline model</a>
  <ul class="collapse">
  <li><a href="#estimation-algorithm" id="toc-estimation-algorithm" class="nav-link" data-scroll-target="#estimation-algorithm">Estimation algorithm</a></li>
  <li><a href="#data-simulation" id="toc-data-simulation" class="nav-link" data-scroll-target="#data-simulation">Data simulation</a></li>
  </ul></li>
  <li><a href="#the-extension-model" id="toc-the-extension-model" class="nav-link" data-scroll-target="#the-extension-model">The extension model</a>
  <ul class="collapse">
  <li><a href="#estimation-algorithm-1" id="toc-estimation-algorithm-1" class="nav-link" data-scroll-target="#estimation-algorithm-1">Estimation algorithm</a></li>
  <li><a href="#data-simulation-1" id="toc-data-simulation-1" class="nav-link" data-scroll-target="#data-simulation-1">Data simulation</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">The Impact of Monetary Policy on the Real Economy and the Stock Market: The Case of Australia</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pun Suparattanapinan </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p><strong>Abstract.</strong> The purpose of this study is to investigate the relationship and impact of monetary policy on the real economy in Australia. The author uses quarterly data spanning from 1990 Q1 to 2023 Q4. The Structural Vector Autoregression (SVAR) model is used to capture the structural relationship, including analyzing the impulse responses of the variable of interest to structural shock.</p>
<p><strong>Keywords.</strong> Structural VAR, SVAR, monetary policy, stock market, economic impact, impulse response function, Bayesian, cash rate</p>
</blockquote>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This study aims to explore the dynamic impact of monetary policy on the real economy in Australia, specifically focusing on economic growth, prices, and employment. How does the real economy respond? What is the magnitude and the duration of change? The stock market price is included and can be considered a leading indicator of the real economy.</p>
<p>According to Economic theory, the transmission mechanism of monetary policy to the real economy takes time, as it does not have a fully immediate effect, but it involves some delays. <span class="citation" data-cites="BrischettoVoss1999">Brischetto and Voss (<a href="#ref-BrischettoVoss1999" role="doc-biblioref">1999</a>)</span> find that the contractionary of monetary policy in Australia leads to a decrease in output level between 5 and 15 quarters after the contraction. The price level also gradually falls with some delay with maximum effect, and there is an indication that the effect tends to be permanent. <span class="citation" data-cites="Mojon2001">Mojon and Peersman (<a href="#ref-Mojon2001" role="doc-biblioref">2001</a>)</span> also investigate the effect of monetary policy across 10 euro area countries and find that a contractionary monetary policy shock leads to a temporary fall in GDP that peaks typically around four quarters after the shock and a gradual decrease in the price level.</p>
<p>On the other hand, <span class="citation" data-cites="Bjornland2009">Bjørnland and Leitemo (<a href="#ref-Bjornland2009" role="doc-biblioref">2009</a>)</span> suggest that, due to the availability of information in financial market, the monetary policy and stock market have simultaneous effects. They also find that real stock prices immediately fall by seven to nine percent due to a monetary policy shock that raises the federal funds rate by 100 basis points. Similarly, <span class="citation" data-cites="Ioannidis2008">Ioannidis and Kontonikas (<a href="#ref-Ioannidis2008" role="doc-biblioref">2008</a>)</span> find that the majority of OECD countries under study, periods of tight money are associated with contemporaneous declines in stock market value and also decreases expected stock returns. Additionally, according to <span class="citation" data-cites="Bjornland2009">Bjørnland and Leitemo (<a href="#ref-Bjornland2009" role="doc-biblioref">2009</a>)</span>, the changes in asset price, particularly stock price, ultimately impact the economic growth by increasing household spending based on their wealth and encouraging investment through the Tobin Q effect. The asset prices also play a role in firm’s ability to fund operations through credit channel. Hence, policymakers are motivated to track the asset price as short-run indicators.</p>
<p>Understanding insights of these dynamic impacts within the macroeconomy, including the magnitude and duration of impacts, enables the policymakers to precisely predict the outcomes on real economy that might occur after changing the new cash target rate.</p>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<p>The variables in this study include the cash rate target <strong><em>(cashrate)</em></strong>, which indicates the monetary policy. GDP (in real terms), CPI, and the unemployment rate <strong><em>(unemprate)</em></strong> are included to measure the real economy. For the stock market, the author uses the All Ordinaries index (AORD) as a representative. The AORD is the market-weighted index and includes about 500 companies from the Australian Stock Exchange. Finally, total government expenditure is included to control for fiscal policy, which might also affect the economy besides monetary policy. The data is collected from the Reserve Bank of Australia (RBA), Australian Bureau of Statistics (ABS), and Yahoo Finance. The dataset spans from 1990 Q1 to 2023 Q4, comprising 136 observations. <a href="#figure-1-time-series-plots-raw-data">Figure 1: time series plots (raw data)</a> represents the raw data time series of these 6 variables.</p>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/plotting the raw data-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-1-time-series-plots-raw-data" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-1-time-series-plots-raw-data">Figure 1: time series plots (raw data)</h5>
</section>
<p><br></p>
<p>The author transforms the data in manner that aligns with the purpose of study. The total government expenditure are adjusted to real terms using the GDP deflator. After that, the author transforms 4 variables which are real GDP, AORD, CPI, and real government expenditure in logarithms term, denoted by <strong><em>realgdp</em></strong>, <strong><em>stockprice</em></strong>, <strong><em>CPI</em></strong>, and <strong><em>govexp</em></strong> respectively. <a href="#figure-2-time-series-plots-transformed-data">Figure 2: time series plots (transformed data)</a> represents the transformed data, which will be analyzed further.</p>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/Plotting the transformed data-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-2-time-series-plots-transformed-data" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-2-time-series-plots-transformed-data">Figure 2: time series plots (transformed data)</h5>
</section>
<p><br></p>
<p>The statistics summary of variables from 1990 Q1 to 2023 Q4 is shown in Table 1.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 1: Summary statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">N</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">St.Dev.</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cashrate</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">4.589</td>
<td style="text-align: right;">2.864</td>
<td style="text-align: right;">0.100</td>
<td style="text-align: right;">16.750</td>
</tr>
<tr class="even">
<td style="text-align: left;">realgdp</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">5.957</td>
<td style="text-align: right;">0.300</td>
<td style="text-align: right;">5.434</td>
<td style="text-align: right;">6.413</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPI</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">4.456</td>
<td style="text-align: right;">0.249</td>
<td style="text-align: right;">4.029</td>
<td style="text-align: right;">4.913</td>
</tr>
<tr class="even">
<td style="text-align: left;">unemprate</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">6.354</td>
<td style="text-align: right;">1.880</td>
<td style="text-align: right;">3.491</td>
<td style="text-align: right;">11.216</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stockprice</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">8.244</td>
<td style="text-align: right;">0.484</td>
<td style="text-align: right;">7.154</td>
<td style="text-align: right;">8.966</td>
</tr>
<tr class="even">
<td style="text-align: left;">govexp</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">10.800</td>
<td style="text-align: right;">0.609</td>
<td style="text-align: right;">9.811</td>
<td style="text-align: right;">11.895</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="preliminary-results" class="level1">
<h1>Preliminary Results</h1>
<section id="the-autocorrelation-and-partial-autocorrelation" class="level3">
<h3 class="anchored" data-anchor-id="the-autocorrelation-and-partial-autocorrelation">The autocorrelation and partial autocorrelation</h3>
<p>In this section, the autocorrelation and partial autocorrelation analyses are used to detect patterns and check the randomness of time series. <a href="#figure-3-acf-plots">Figure 3: ACF plots</a> show the autocorrelation remains in all variables, even after 5 years. This indicate the strong correlation between a time series and its lagged values.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/ACF plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-3-acf-plots" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-3-acf-plots">Figure 3: ACF plots</h5>
</section>
<p><br></p>
<p>For the PACF in <a href="#figure-4-pacf-plots">Figure 4: PACF plots</a>, it is observed that there have not been any significant spikes for all variables, except for <em>unemprate</em>. The PACF of <em>unemprate</em> indicates significance in partial autocorrelation at first and sixteenth quarter lags; however, this might occur due to a type I error.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/PACF plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="figure-4-pacf-plots" class="level5" style="text-align: center;">
<h5 class="anchored" data-anchor-id="figure-4-pacf-plots">Figure 4: PACF plots</h5>
</section>
<p><br></p>
</section>
<section id="the-unit-root-test" class="level3">
<h3 class="anchored" data-anchor-id="the-unit-root-test">The unit root test</h3>
<p>In this section, the Augmented Dickey-Fuller Test (ADF Test) is used to test for the stationarity assumption. The null hypothesis is that the time series data has a unit root (non-stationary). The results are shown in Table 2. At the 1% significance level, the null hypothesis cannot be rejected for all variables, indicating that these variables are unit root non-stationary.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 2: ADF test</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Dickey-Fuller</th>
<th style="text-align: right;">Lag order</th>
<th style="text-align: right;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cashrate</td>
<td style="text-align: right;">-3.77</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">realgdp</td>
<td style="text-align: right;">-1.30</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.87</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPI</td>
<td style="text-align: right;">-3.11</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">unemprate</td>
<td style="text-align: right;">-2.61</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stockprice</td>
<td style="text-align: right;">-2.57</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.34</td>
</tr>
<tr class="even">
<td style="text-align: left;">govexp</td>
<td style="text-align: right;">-1.84</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.64</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Then, take the first difference and the second difference of all variables and rerun the ADF test. The results are shown in Table 3 and Table 4. For the first difference in Table 3, at the 1% significance level, the null hypothesis can be rejected for all variables, except <em>CPI</em> and <em>dgovexp</em>. It is reasonable to conclude that <em>cashrate</em>, <em>realgdp</em>, <em>unemprate</em>, <em>stockprice</em> are integrated of order 1. And <em>CPI</em> and <em>govexp</em> are integrated of order 2, as shown in the result in Table 4.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 3: ADF test on the first difference</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Dickey-Fuller</th>
<th style="text-align: right;">Lag order</th>
<th style="text-align: right;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">dcashrate</td>
<td style="text-align: right;">-4.26</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">drealgdp</td>
<td style="text-align: right;">-5.76</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dCPI</td>
<td style="text-align: right;">-3.87</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">dunemprate</td>
<td style="text-align: right;">-4.96</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dstockprice</td>
<td style="text-align: right;">-5.47</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">dgovexp</td>
<td style="text-align: right;">-3.75</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.02</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table 4: ADF test on the second difference</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Dickey-Fuller</th>
<th style="text-align: right;">Lag order</th>
<th style="text-align: right;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ddcashrate</td>
<td style="text-align: right;">-7.20</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">ddrealgdp</td>
<td style="text-align: right;">-8.23</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ddCPI</td>
<td style="text-align: right;">-6.05</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">ddunemprate</td>
<td style="text-align: right;">-6.49</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ddstockprice</td>
<td style="text-align: right;">-7.55</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">ddgovexp</td>
<td style="text-align: right;">-9.00</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="methodology" class="level1">
<h1>Methodology</h1>
<p>In this section, the model that this study use to capture the structural relationship between real economy variables and the stock price is introduced. The author use Structural Vector Autoregression (SVAR) model which comprises of 6 variables, <em>cashrate</em>, <em>realgdp</em>, <em>inflation</em>, <em>unemprate</em>, <em>stockprice</em>, and <em>govexp</em>. Subsequently, the model will be used to analyze the impulse responses.</p>
<p>The <strong>SVAR model</strong> can be shown as follows.</p>
<span class="math display">\[\begin{align}
B_0y_t &amp;= b_0 + \sum_{i=1}^{p}B_{i}y_{t-i}+u_t  \\
u_t|Y_{t-1}&amp;\sim iid \mathcal{N} (0_N,I_N)
\end{align}\]</span>
<p>where :</p>
<p><span class="math inline">\(y_{t}\)</span> is <span class="math inline">\(N\times1\)</span> vector of endogenous variables at time t</p>
<p><span class="math inline">\(B_0\)</span> is <span class="math inline">\(N\times N\)</span> structural matrix which captures the contemporaneous relationships between variables</p>
<p><span class="math inline">\(u_t\)</span> is <span class="math inline">\(N\times1\)</span> vector of conditionally on <span class="math inline">\(Y_{t-1}\)</span> orthogonal or independent structural shocks</p>
<p><br></p>
<p>Specifically, <span class="math inline">\(y_{t}\)</span> contains 6 variables as follows. <span class="math display">\[
y_t = \begin{pmatrix}
\text{cashrate} \\
\text{realgdp} \\
\text{CPI} \\
\text{unemprate} \\
\text{stockprice} \\
\text{govexp}
\end{pmatrix}
\]</span></p>
<p>The <strong>reduced form</strong> can be shown as follows.</p>
<span class="math display">\[\begin{align}
y_t &amp;= \mu_0 + \sum_{i=1}^{p}A_{i}y_{t-i}+\epsilon_t \\
\epsilon_t|Y_{t-1} &amp;\sim iid \mathcal{N}(0_N,\Sigma)
\end{align}\]</span>
<p>where :</p>
<p><span class="math inline">\(A_i\)</span> is <span class="math inline">\(N\times N\)</span> matrix of autoregressive slope parameters</p>
<p><span class="math inline">\(\mu_0\)</span> is <span class="math inline">\(N\times1\)</span> vector of constant terms</p>
<p><span class="math inline">\(\epsilon_t\)</span> is <span class="math inline">\(N\times1\)</span> vector of error terms - a multivariate white noise process</p>
<p><span class="math inline">\(\Sigma\)</span> is <span class="math inline">\(N\times N\)</span> covariance matrix of the error term</p>
</section>
<section id="estimation" class="level1">
<h1>Estimation</h1>
<section id="the-baseline-model" class="level2">
<h2 class="anchored" data-anchor-id="the-baseline-model">The baseline model</h2>
<section id="estimation-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="estimation-algorithm">Estimation algorithm</h3>
<p>The reduced form above can be rewrite in the matrix form as follows:</p>
<span class="math display">\[\begin{align}
Y &amp;= XA + E \\
E|X &amp;\sim \mathcal{MN}_{T \times N}(0,\Sigma,I_T)
\end{align}\]</span>
<p>Bayes’ rule is employed for deriving the posterior distribution</p>
<p>From Bayes’ rule:</p>
<span class="math display">\[\begin{align}
P(A,\Sigma|Y,X) &amp;\propto L(A,\Sigma|Y,X)P(A,\Sigma) \\
\underbrace{P(A,\Sigma|Y,X)}_{\text{Posterior distribution}} &amp;\propto \underbrace{L(A,\Sigma|Y,X)}_{\text{Likelihood}} \underbrace{P(A|\Sigma)P(\Sigma)}_{\text{Prior distribution}}
\end{align}\]</span>
<p><br></p>
<section id="the-likelihood-fuction" class="level4">
<h4 class="anchored" data-anchor-id="the-likelihood-fuction">The likelihood fuction</h4>
<p>The derivation of the likelihood function can be shown in matrix-variate normal distribution as follows:</p>
<span class="math display">\[\begin{align}
L(A,\Sigma|Y,X) = (2\pi)^{-\frac{NT}{2}} det(\Sigma)^{-\frac{T}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(Y-XA)'(Y-XA) \right] \right\} \\
\end{align}\]</span>
<p>Then, the <span class="math inline">\(\hat{A}\)</span> and <span class="math inline">\(\hat{\Sigma}\)</span> corresponding to the maximum likelihood are</p>
<span class="math display">\[\begin{align}
\hat{A} &amp;= (X'X)^{-1}X'Y \\
\hat{\Sigma} &amp;= \frac{1}{T} (Y-X \hat{A})'(Y-X \hat{A})
\end{align}\]</span>
<p>The likelihood function can be represented as Normal inverse Wishart distribution</p>
<span class="math display">\[\begin{align}
L(A,\Sigma|Y,X) &amp;\propto det(\Sigma)^{-\frac{T}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\hat{A})'X'X(Y-\hat{A}) \right] \right\}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(Y-X\hat{A})'(Y-X\hat{A}) \right] \right\} \\
\end{align}\]</span>
<p><br></p>
</section>
<section id="the-prior-distribution" class="level4">
<h4 class="anchored" data-anchor-id="the-prior-distribution">The prior distribution</h4>
<span class="math display">\[\begin{align}
P(A,\Sigma) &amp;= P(A|\Sigma) P(\Sigma) \\
A|\Sigma &amp;\sim \mathcal{MN}_{K \times N} (\underline{A}, \Sigma , \underline{V}) \\
\Sigma &amp;\sim \mathcal{IW}_{N}(\underline{S},\underline{\nu})
\end{align}\]</span>
<p>The prior which follows Normal inverse Wishart distribution:</p>
<span class="math display">\[\begin{align}
p(A,\Sigma) &amp;\propto det(\Sigma)^{-\frac{N+K+\underline{\nu}+1}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\underline{A})'\underline{V}^{-1}(A-\underline{A}) \right] \right\}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}\underline{S} \right] \right\}
\\
\end{align}\]</span>
<p>The Minnesota prior used as prior of the model, the parameters are follows:</p>
<span class="math display">\[\begin{align}
\underline{A} &amp;= [0_{N \times 1} \quad I_N \quad 0_{N \times (p-1)N}]' \\
Var[vec(A)] &amp;= \Sigma \otimes  \underline{V} \\
\underline{V} &amp;= \text{diag}([\kappa_2 \quad \kappa_1 (p^{-2} \otimes \imath_N)]) \\
\end{align}\]</span>
<p>where:</p>
<p><span class="math inline">\(p\)</span> = [1,2,…,p]</p>
<p><span class="math inline">\(\imath_N\)</span> = [1,…,1]</p>
<p><span class="math inline">\(\kappa_1\)</span> is overall shrinkage level for autoregressive slopes, the common value is <span class="math inline">\(0.02^{2}\)</span></p>
<p><span class="math inline">\(\kappa_2\)</span> is overall shrinkage level for the constant term, the common value is <span class="math inline">\(100\)</span></p>
<span class="math display">\[\begin{align}
P(A,\Sigma) &amp;\propto det(\Sigma)^{-\frac{N+K+\underline{\nu}+1}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\underline{A})'\underline{V}^{-1}(A-\underline{A}) \right] \right\}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}\underline{S} \right] \right\}
\\
\end{align}\]</span>
<p><br> #### The posterior distribution From the Bayes’ rule mentioned above, the posterior distribution as follows:</p>
<span class="math display">\[\begin{align}
P(A,\Sigma|Y,X) \propto &amp; L(A,\Sigma|Y,X)P(A,\Sigma) \\
P(A,\Sigma|Y,X) \propto
&amp; det(\Sigma)^{-\frac{T}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\hat{A})'X'X(A-\hat{A}) \right] \right\}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(Y-X\hat{A})'(Y-X\hat{A}) \right] \right\} \\
&amp;det(\Sigma)^{-\frac{N+K+\underline{\nu}+1}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\underline{A})'\underline{V}^{-1}(A-\underline{A}) \right] \right\}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}\underline{S} \right] \right\} \\
P(A,\Sigma|Y,X) \propto
&amp; det(\Sigma)^{-\frac{T+N+K+\underline{\nu}+1}{2}}
exp \left\{-\frac{1}{2} tr \left[
\Sigma^{-1}\left[(A-\hat{A})'X'X(A-\hat{A}) + (A-\underline{A})'\underline{V}^{-1}(A-\underline{A}) \\
+(Y-X\hat{A})'(Y-X\hat{A})+\underline{S})\right] \right] \right\}

\\

\end{align}\]</span>
<p>Which can represented in form of Normal inverse Wishart distribution</p>
<span class="math display">\[\begin{align}
P(A,\Sigma|Y,X) &amp;= P(A|Y,X,\Sigma) P(\Sigma|Y,X) \\
P(A|Y,X,\Sigma) &amp;\sim \mathcal{MN}_{K \times N} (\overline{A}, \Sigma , \overline{V}) \\
P(\Sigma|Y,X) &amp;\sim \mathcal{IW}_{N}(\overline{S},\overline{\nu})
\end{align}\]</span>
<p><br> And the posterior parameters are structured as follows.</p>
<span class="math display">\[\begin{align}

\overline{V} &amp;= (X'X+ \underline{V}^{-1})^{-1} \\
\overline{A} &amp;= \overline{V}(X'Y+\underline{V}^{-1} \underline{A})\\
\overline{\nu} &amp;= T+\underline{\nu}\\
\overline{S} &amp;= \underline{S}+Y'Y + \underline{A}'\underline{V}^{-1}\underline{A} -
\overline{A}'\overline{V}^{-1}\overline{A} \\

\end{align}\]</span>
</section>
</section>
<section id="data-simulation" class="level3">
<h3 class="anchored" data-anchor-id="data-simulation">Data simulation</h3>
<p>The author generates 1,000 observations from bi-variate Gaussian random walk process to prove that the algorithm works.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/plot random walk-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The target model for estimation is a Sign-Restricted Structural Vector Autoregression (SVAR).</p>
<span class="math display">\[\begin{align}
B_0y_t &amp;= b_0 + \sum_{i=1}^{p}B_{1}y_{t-1}+u_t  \\
u_t|Y_{t-1}&amp;\sim iid \mathcal{N} (0_N,I_N)
\end{align}\]</span>
<p>The author randomly draws matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(\Sigma\)</span> from the posterior distribution, which is specified as a Normal Inverse Wishart distribution as described earlier. Following this, the sign restriction is applied to the main diagonal of matrix <span class="math inline">\(B_{0}\)</span>, ensuring positive signs.</p>
<p>Table 5 displays that the mean values of the main diagonal elements in matrix <span class="math inline">\(B_{0}\)</span> are positive, providing evidence for the validity of the imposed restriction.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table5: Mean of the B0 matrix (Baseline model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.6395591</td>
<td style="text-align: right;">-0.0220170</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">0.0402778</td>
<td style="text-align: right;">0.6467075</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In Table 6, the values in the first column, which represent the constant term in the equation, are close to zero.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table6: Mean of the B+ matrix (Baseline model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
<th style="text-align: right;">C3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.0346082</td>
<td style="text-align: right;">0.6354305</td>
<td style="text-align: right;">-0.0212149</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">0.0155527</td>
<td style="text-align: right;">0.0446449</td>
<td style="text-align: right;">0.6432964</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="the-extension-model" class="level2">
<h2 class="anchored" data-anchor-id="the-extension-model">The extension model</h2>
<section id="estimation-algorithm-1" class="level3">
<h3 class="anchored" data-anchor-id="estimation-algorithm-1">Estimation algorithm</h3>
<p>Suppose the author aims to enhance the flexibility of the prior distribution for gamma (<span class="math inline">\(\gamma\)</span>) by modeling it in the following manner.</p>
<span class="math display">\[\begin{align}
\color{Grey}P(A,\Sigma\color{Black}|\gamma) &amp;= \color{Grey}P(A|\Sigma) P(\Sigma\color{Black}|\gamma) \\
\color{Grey}A|\Sigma &amp;\sim \color{Grey}\mathcal{MN}_{K \times N} \color{Grey}(\underline{A}, \Sigma , \underline{V}) \\
\color{Black}\Sigma|\gamma &amp;\sim \mathcal{IW}_{N}(\gamma I_{N},\underline{\nu}) \\
\gamma &amp;\sim \mathcal{IG2} (\underline{S},\underline{\nu})
\end{align}\]</span>
<p>Thus, the the posterior distribution as follows:</p>
<span class="math display">\[\begin{align}
P(A,\Sigma|Y,X,\gamma) \propto &amp; L(A,\Sigma|Y,X,\gamma)P(A,\Sigma) \\
P(A,\Sigma|Y,X,\gamma) \propto &amp; L(A,\Sigma|Y,X,\gamma)P(A|\Sigma) P(\Sigma|\gamma) \\
P(A,\Sigma|Y,X,\gamma) \propto
&amp; det(\Sigma)^{-\frac{T}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\hat{A})'X'X(A-\hat{A}) \right] \right\}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(Y-X\hat{A})'(Y-X\hat{A}) \right] \right\} \\
&amp;det(\Sigma)^{-\frac{N+K+\underline{\nu}+1}{2}}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\underline{A})'\underline{V}^{-1}(A-\underline{A}) \right] \right\}
exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}\gamma I_{N} \right] \right\} \\
P(A,\Sigma|Y,X,\gamma) \propto
&amp; det(\Sigma)^{-\frac{T+N+K+\underline{\nu}+1}{2}}
exp \left\{-\frac{1}{2} tr \left[
\Sigma^{-1}\left[(A-\hat{A})'X'X(A-\hat{A}) + (A-\underline{A})'\underline{V}^{-1}(A-\underline{A}) \\
+(Y-X\hat{A})'(Y-X\hat{A})+\gamma I_{N}\right] \right] \right\} \\

\end{align}\]</span>
<p>The distribution represented in the form of Normal Inverse Wishart is characterized by the following parameters:</p>
<span class="math display">\[\begin{align}

\overline{V} &amp;= (X'X+ \underline{V}^{-1})^{-1} \\
\overline{A} &amp;= \overline{V}(X'Y+\underline{V}^{-1} \underline{A})\\
\overline{\nu} &amp;= T+\underline{\nu}\\
\overline{S} &amp;= \gamma I_{N}+Y'Y + \underline{A}'\underline{V}^{-1}\underline{A} -
\overline{A}'\overline{V}^{-1}\overline{A} \\

\end{align}\]</span>
<p><br> The posterior distribution of <span class="math inline">\(\gamma\)</span> is also needed as it serves as a crucial component for the sampling procedure.</p>
<span class="math display">\[\begin{align}
P(\gamma|A,\Sigma,Y,X) \propto &amp; L(Y|\Sigma,X,A)P(\gamma)P(A,\Sigma)P(\Sigma|\gamma) \\
\propto &amp; P(\gamma)P(\Sigma|\gamma) \\

= &amp; \gamma^{-\frac{\underline{\nu}+2}{2}}\:exp\left\{{-\frac{1}{2}\frac{\underline{S}}{\lambda}} \right\} \:det(\gamma I_{N})^{\frac{\underline{\nu}}{2}}\:det(\Sigma)^{-\frac{\underline{\nu}+N+1}{2}}\:exp\left\{{-\frac{1}{2}tr[\Sigma^{-1}\gamma I_{N}]} \right\} \\

= &amp;\gamma^{-\frac{\underline{\nu}+2}{2}}\:exp\left\{{-\frac{1}{2}\frac{\underline{S}}{\gamma}} \right\}\:\gamma^{-\frac{N\underline{\nu}}{2}}\:det(\Sigma)^{\frac{\underline{\nu}+N+1}{2}}\:exp\left\{{-\frac{1}{2}\gamma \:tr[\Sigma^{-1}]} \right\} \\

\propto &amp;\gamma^{\frac{N\underline{\nu}-\underline{\nu}}{2}-1} \:
exp\left\{{-\frac{1}{2}}[\gamma\:tr[\Sigma^{-1}]+{\frac{\underline{S}}{\gamma}}]\right\} \\

\end{align}\]</span>
<p>The following distribution conforms to the Generalized Inverse Gaussian (GIG) distribution, with the parameters as follows:</p>
<span class="math display">\[\begin{align}
\lambda = {\frac{N\underline{\nu}-\underline{\nu}}{2}} \\

\\ \chi = \underline{S}\\

\\ \psi = tr[\Sigma^{-1}]
\end{align}\]</span>
<p>The Gibbs Sampler is used to get the posterior draws of the extended model</p>
<p>For S = 1,000 iterations</p>
<p>Initialize <span class="math inline">\(\gamma\)</span> at <span class="math inline">\(\gamma^{(0)}\)</span></p>
<p>At each iteration:</p>
<ol type="1">
<li>Draw <span class="math inline">\(\Sigma^{(s)} \sim P(\Sigma|Y,X,\gamma^{(s-1)})\)</span></li>
<li>Draw <span class="math inline">\(A^{(s)}\sim P(A|\Sigma^{(s)},Y,X)\)</span></li>
<li>Draw <span class="math inline">\(\gamma^{(s)} \sim P(\gamma|Y,X,A^{(s)},\Sigma^{(s)})\)</span></li>
</ol>
<p>The author then utilizes the random draws from <span class="math inline">\(\Sigma^{(s)}, A^{(s)}, \gamma^{(s)}\)</span> to obtain the posterior draw and create the following B0 and B plus matrices.</p>
</section>
<section id="data-simulation-1" class="level3">
<h3 class="anchored" data-anchor-id="data-simulation-1">Data simulation</h3>
<p>Table 7 indicates that the mean value of the main diagonal of <span class="math inline">\(B_{0}\)</span> remains positive, exhibiting a similar behavior to that of the basic model.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table7: Mean of the B0 matrix (extension model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.6483893</td>
<td style="text-align: right;">0.0451440</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">-0.0325026</td>
<td style="text-align: right;">0.6532864</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table8: Mean of the B+ matrix (extension model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">C1</th>
<th style="text-align: right;">C2</th>
<th style="text-align: right;">C3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R1</td>
<td style="text-align: right;">0.0373085</td>
<td style="text-align: right;">0.6471392</td>
<td style="text-align: right;">0.0441081</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: right;">0.0099539</td>
<td style="text-align: right;">-0.0276806</td>
<td style="text-align: right;">0.6509088</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="references" class="level2 unnumbered">




</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Bjornland2009" class="csl-entry" role="listitem">
Bjørnland, HC, and K Leitemo. 2009. <span>“Identifying the Interdependence Between US Monetary Policy and the Stock Market.”</span> <em>Journal of Monetary Economics</em> 56(2): 275–82. <a href="https://doi.org/10.1016/j.jmoneco.2008.12.001">https://doi.org/10.1016/j.jmoneco.2008.12.001</a>.
</div>
<div id="ref-BrischettoVoss1999" class="csl-entry" role="listitem">
Brischetto, Andrea, and Graham Voss. 1999. <span>“A Structural Vector Autoregression Model of Monetary Policy in Australia.”</span> <em>Reserve Bank of Australia</em>.
</div>
<div id="ref-Ioannidis2008" class="csl-entry" role="listitem">
Ioannidis, Christos, and Alexandros Kontonikas. 2008. <span>“The Impact of Monetary Policy on Stock Prices. Journal of Policy Modeling.”</span> <em>Journal of Policy Modeling</em> 30(1): 33–53. <a href="https://doi.org/10.1016/j.jpolmod.2007.06.015">https://doi.org/10.1016/j.jpolmod.2007.06.015</a>.
</div>
<div id="ref-Mojon2001" class="csl-entry" role="listitem">
Mojon, Benoit, and Gert Peersman. 2001. <span>“A VAR Description of the Effects of Monetary Policy in the Individual Countries of the Euro Area.”</span> <a href="http://dx.doi.org/10.2139/ssrn.303801">http://dx.doi.org/10.2139/ssrn.303801</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>